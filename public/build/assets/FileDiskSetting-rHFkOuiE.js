import{u as N}from"./disk-BGb30Eo6.js";import{a0 as j,G as O,v as A,e as p,j as b,f as g,g as D,i as T,aG as R,I as L,r as m,c as w,o as $,b as _,a4 as Y,a as o,L as h,w as l,t as q,m as z,ai as ae,K as G,a5 as ie,q as U,ao as oe,F as te,a9 as re,Q as se,a7 as ne,l as J,M as le}from"./main-DnObvGgc.js";const de={props:{isEdit:{type:Boolean,require:!0,default:!1},loading:{type:Boolean,require:!0,default:!1},disks:{type:Array,require:!0,default:Array}},emits:["submit","onChangeDisk"],setup(r,{emit:a}){const t=N(),e=O(),{t:d}=A.useI18n();let f=p(!1),s=p(!1),n=p(null),u=p(null);const c=b({get:()=>t.selected_driver,set:k=>{t.selected_driver=k,t.dropBoxDiskConfig.selected_driver=k}}),v=b(()=>({dropBoxDiskConfig:{root:{required:g.withMessage(d("validation.required"),D)},key:{required:g.withMessage(d("validation.required"),D)},secret:{required:g.withMessage(d("validation.required"),D)},token:{required:g.withMessage(d("validation.required"),D)},app:{required:g.withMessage(d("validation.required"),D)},selected_driver:{required:g.withMessage(d("validation.required"),D)},name:{required:g.withMessage(d("validation.required"),D)}}})),i=T(v,b(()=>t));R(()=>{t.dropBoxDiskConfig={name:null,selected_driver:"dropbox",token:null,key:null,secret:null,app:null}}),y();async function y(){s.value=!0;let k=L({disk:"dropbox"});if(r.isEdit)Object.assign(t.dropBoxDiskConfig,e.data),f.value=e.data.set_as_default,f.value&&(n.value=!0);else{let S=await t.fetchDiskEnv(k);Object.assign(t.dropBoxDiskConfig,S.data)}u.value=r.disks.find(S=>S.value=="dropbox"),s.value=!1}const x=b(()=>!!(r.isEdit&&f.value&&n.value));async function M(){if(i.value.dropBoxDiskConfig.$touch(),i.value.dropBoxDiskConfig.$invalid)return!0;let k={credentials:t.dropBoxDiskConfig,name:t.dropBoxDiskConfig.name,driver:u.value.value,set_as_default:f.value};return a("submit",k),!1}function I(){a("onChangeDisk",t.dropBoxDiskConfig.selected_driver)}return{v$:i,diskStore:t,selected_driver:c,set_as_default:f,isLoading:s,is_current_disk:n,selected_disk:u,isDisabled:x,loadData:y,submitData:M,onChangeDriver:I}}},ue={class:"px-8 py-6"},me={key:0,class:"flex items-center mt-6"},fe={class:"relative flex items-center w-12"},ke={class:"ml-4 right"},ge={class:"p-0 mb-1 text-base leading-snug text-black box-title"};function ve(r,a,t,e,d,f){const s=m("BaseInput"),n=m("BaseInputGroup"),u=m("BaseMultiselect"),c=m("BaseInputGrid"),v=m("BaseSwitch");return $(),w("form",{onSubmit:a[15]||(a[15]=z((...i)=>e.submitData&&e.submitData(...i),["prevent"]))},[_("div",ue,[o(c,null,{default:l(()=>[o(n,{label:r.$t("settings.disk.name"),error:e.v$.dropBoxDiskConfig.name.$error&&e.v$.dropBoxDiskConfig.name.$errors[0].$message,required:""},{default:l(()=>[o(s,{modelValue:e.diskStore.dropBoxDiskConfig.name,"onUpdate:modelValue":a[0]||(a[0]=i=>e.diskStore.dropBoxDiskConfig.name=i),type:"text",name:"name",invalid:e.v$.dropBoxDiskConfig.name.$error,onInput:a[1]||(a[1]=i=>e.v$.dropBoxDiskConfig.name.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),o(n,{label:r.$t("settings.disk.driver"),error:e.v$.dropBoxDiskConfig.selected_driver.$error&&e.v$.dropBoxDiskConfig.selected_driver.$errors[0].$message,required:""},{default:l(()=>[o(u,{modelValue:e.selected_driver,"onUpdate:modelValue":[a[2]||(a[2]=i=>e.selected_driver=i),a[3]||(a[3]=i=>e.onChangeDriver(r.data))],invalid:e.v$.dropBoxDiskConfig.selected_driver.$error,"value-prop":"value",options:t.disks,searchable:"",label:"name","can-deselect":!1},null,8,["modelValue","invalid","options"])]),_:1},8,["label","error"]),o(n,{label:r.$t("settings.disk.dropbox_root"),error:e.v$.dropBoxDiskConfig.root.$error&&e.v$.dropBoxDiskConfig.root.$errors[0].$message,required:""},{default:l(()=>[o(s,{modelValue:e.diskStore.dropBoxDiskConfig.root,"onUpdate:modelValue":a[4]||(a[4]=i=>e.diskStore.dropBoxDiskConfig.root=i),modelModifiers:{trim:!0},type:"text",name:"name",placeholder:"Ex. /user/root/",invalid:e.v$.dropBoxDiskConfig.root.$error,onInput:a[5]||(a[5]=i=>e.v$.dropBoxDiskConfig.root.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),o(n,{label:r.$t("settings.disk.dropbox_token"),error:e.v$.dropBoxDiskConfig.token.$error&&e.v$.dropBoxDiskConfig.token.$errors[0].$message,required:""},{default:l(()=>[o(s,{modelValue:e.diskStore.dropBoxDiskConfig.token,"onUpdate:modelValue":a[6]||(a[6]=i=>e.diskStore.dropBoxDiskConfig.token=i),modelModifiers:{trim:!0},type:"text",name:"name",invalid:e.v$.dropBoxDiskConfig.token.$error,onInput:a[7]||(a[7]=i=>e.v$.dropBoxDiskConfig.token.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),o(n,{label:r.$t("settings.disk.dropbox_key"),error:e.v$.dropBoxDiskConfig.key.$error&&e.v$.dropBoxDiskConfig.key.$errors[0].$message,required:""},{default:l(()=>[o(s,{modelValue:e.diskStore.dropBoxDiskConfig.key,"onUpdate:modelValue":a[8]||(a[8]=i=>e.diskStore.dropBoxDiskConfig.key=i),modelModifiers:{trim:!0},type:"text",name:"name",placeholder:"Ex. KEIS4S39SERSDS",invalid:e.v$.dropBoxDiskConfig.key.$error,onInput:a[9]||(a[9]=i=>e.v$.dropBoxDiskConfig.key.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),o(n,{label:r.$t("settings.disk.dropbox_secret"),error:e.v$.dropBoxDiskConfig.secret.$error&&e.v$.dropBoxDiskConfig.secret.$errors[0].$message,required:""},{default:l(()=>[o(s,{modelValue:e.diskStore.dropBoxDiskConfig.secret,"onUpdate:modelValue":a[10]||(a[10]=i=>e.diskStore.dropBoxDiskConfig.secret=i),modelModifiers:{trim:!0},type:"text",name:"name",placeholder:"Ex. ********",invalid:e.v$.dropBoxDiskConfig.secret.$error,onInput:a[11]||(a[11]=i=>e.v$.dropBoxDiskConfig.secret.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),o(n,{label:r.$t("settings.disk.dropbox_app"),error:e.v$.dropBoxDiskConfig.app.$error&&e.v$.dropBoxDiskConfig.app.$errors[0].$message,required:""},{default:l(()=>[o(s,{modelValue:e.diskStore.dropBoxDiskConfig.app,"onUpdate:modelValue":a[12]||(a[12]=i=>e.diskStore.dropBoxDiskConfig.app=i),modelModifiers:{trim:!0},type:"text",name:"name",invalid:e.v$.dropBoxDiskConfig.app.$error,onInput:a[13]||(a[13]=i=>e.v$.dropBoxDiskConfig.app.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"])]),_:1}),e.isDisabled?h("",!0):($(),w("div",me,[_("div",fe,[o(v,{modelValue:e.set_as_default,"onUpdate:modelValue":a[14]||(a[14]=i=>e.set_as_default=i),class:"flex"},null,8,["modelValue"])]),_("div",ke,[_("p",ge,q(r.$t("settings.disk.is_default")),1)])]))]),Y(r.$slots,"default",{diskData:{isLoading:e.isLoading,submitData:e.submitData}})],32)}const De=j(de,[["render",ve]]),ce={props:{isEdit:{type:Boolean,require:!0,default:!1},loading:{type:Boolean,require:!0,default:!1},disks:{type:Array,require:!0,default:Array}},emits:["submit","onChangeDisk"],setup(r,{emit:a}){const t=N(),e=O(),{t:d}=A.useI18n();let f=p(!1),s=p(!1),n=p(""),u=p(null);const c=b({get:()=>t.selected_driver,set:k=>{t.selected_driver=k,t.localDiskConfig.selected_driver=k}}),v=b(()=>({localDiskConfig:{name:{required:g.withMessage(d("validation.required"),D)},selected_driver:{required:g.withMessage(d("validation.required"),D)},root:{required:g.withMessage(d("validation.required"),D)}}})),i=T(v,b(()=>t));R(()=>{t.localDiskConfig={name:null,selected_driver:"local",root:null}}),y();async function y(){f.value=!0;let k=L({disk:"local"});if(r.isEdit)Object.assign(t.localDiskConfig,e.data),t.localDiskConfig.root=e.data.credentials,s.value=e.data.set_as_default,s.value&&(u.value=!0);else{let S=await t.fetchDiskEnv(k);Object.assign(t.localDiskConfig,S.data)}n.value=r.disks.find(S=>S.value=="local"),f.value=!1}const x=b(()=>!!(r.isEdit&&s.value&&u.value));async function M(){if(i.value.localDiskConfig.$touch(),i.value.localDiskConfig.$invalid)return!0;let k=L({credentials:t.localDiskConfig.root,name:t.localDiskConfig.name,driver:t.localDiskConfig.selected_driver,set_as_default:s.value});return a("submit",k),!1}function I(){a("onChangeDisk",t.localDiskConfig.selected_driver)}return{v$:i,diskStore:t,modalStore:e,selected_driver:c,selected_disk:n,isLoading:f,set_as_default:s,is_current_disk:u,submitData:M,onChangeDriver:I,isDisabled:x}}},Ce={class:"px-4 sm:px-8 py-6"},pe={key:0,class:"flex items-center mt-6"},_e={class:"relative flex items-center w-12"},be={class:"ml-4 right"},Se={class:"p-0 mb-1 text-base leading-snug text-black box-title"};function $e(r,a,t,e,d,f){const s=m("BaseInput"),n=m("BaseInputGroup"),u=m("BaseMultiselect"),c=m("BaseInputGrid"),v=m("BaseSwitch");return $(),w("form",{action:"",onSubmit:a[7]||(a[7]=z((...i)=>e.submitData&&e.submitData(...i),["prevent"]))},[_("div",Ce,[o(c,null,{default:l(()=>[o(n,{label:r.$t("settings.disk.name"),error:e.v$.localDiskConfig.name.$error&&e.v$.localDiskConfig.name.$errors[0].$message,required:""},{default:l(()=>[o(s,{modelValue:e.diskStore.localDiskConfig.name,"onUpdate:modelValue":a[0]||(a[0]=i=>e.diskStore.localDiskConfig.name=i),type:"text",name:"name",invalid:e.v$.localDiskConfig.name.$error,onInput:a[1]||(a[1]=i=>e.v$.localDiskConfig.name.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),o(n,{label:r.$t("settings.disk.driver"),error:e.v$.localDiskConfig.selected_driver.$error&&e.v$.localDiskConfig.selected_driver.$errors[0].$message,required:""},{default:l(()=>[o(u,{modelValue:e.selected_driver,"onUpdate:modelValue":[a[2]||(a[2]=i=>e.selected_driver=i),a[3]||(a[3]=i=>e.onChangeDriver(r.data))],"value-prop":"value",invalid:e.v$.localDiskConfig.selected_driver.$error,options:t.disks,searchable:"",label:"name","can-deselect":!1},null,8,["modelValue","invalid","options"])]),_:1},8,["label","error"]),o(n,{label:r.$t("settings.disk.local_root"),error:e.v$.localDiskConfig.root.$error&&e.v$.localDiskConfig.root.$errors[0].$message,required:""},{default:l(()=>[o(s,{modelValue:e.diskStore.localDiskConfig.root,"onUpdate:modelValue":a[4]||(a[4]=i=>e.diskStore.localDiskConfig.root=i),modelModifiers:{trim:!0},type:"text",name:"name",invalid:e.v$.localDiskConfig.root.$error,placeholder:"Ex./user/root/",onInput:a[5]||(a[5]=i=>e.v$.localDiskConfig.root.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"])]),_:1}),e.isDisabled?h("",!0):($(),w("div",pe,[_("div",_e,[o(v,{modelValue:e.set_as_default,"onUpdate:modelValue":a[6]||(a[6]=i=>e.set_as_default=i),class:"flex"},null,8,["modelValue"])]),_("div",be,[_("p",Se,q(r.$t("settings.disk.is_default")),1)])]))]),Y(r.$slots,"default",{diskData:{isLoading:e.isLoading,submitData:e.submitData}})],32)}const ye=j(ce,[["render",$e]]),Be={props:{isEdit:{type:Boolean,require:!0,default:!1},loading:{type:Boolean,require:!0,default:!1},disks:{type:Array,require:!0,default:Array}},emits:["submit","onChangeDisk"],setup(r,{emit:a}){const t=N(),e=O(),{t:d}=A.useI18n();let f=p(!1),s=p(!1),n=p(null),u=p(null);const c=b({get:()=>t.selected_driver,set:k=>{t.selected_driver=k,t.s3DiskConfigData.selected_driver=k}}),v=b(()=>({s3DiskConfigData:{name:{required:g.withMessage(d("validation.required"),D)},root:{required:g.withMessage(d("validation.required"),D)},key:{required:g.withMessage(d("validation.required"),D)},secret:{required:g.withMessage(d("validation.required"),D)},region:{required:g.withMessage(d("validation.required"),D)},bucket:{required:g.withMessage(d("validation.required"),D)},selected_driver:{required:g.withMessage(d("validation.required"),D)}}})),i=T(v,b(()=>t));R(()=>{t.s3DiskConfigData={name:null,selected_driver:"s3",key:null,secret:null,region:null,bucket:null,root:null}}),y();async function y(){s.value=!0;let k=L({disk:"s3"});if(r.isEdit)Object.assign(t.s3DiskConfigData,e.data),f.value=e.data.set_as_default,f.value&&(u.value=!0);else{let S=await t.fetchDiskEnv(k);Object.assign(t.s3DiskConfigData,S.data)}n.value=r.disks.find(S=>S.value=="s3"),s.value=!1}const x=b(()=>!!(r.isEdit&&f.value&&u.value));async function M(){if(i.value.s3DiskConfigData.$touch(),i.value.s3DiskConfigData.$invalid)return!0;let k={credentials:t.s3DiskConfigData,name:t.s3DiskConfigData.name,driver:n.value.value,set_as_default:f.value};return a("submit",k),!1}function I(){a("onChangeDisk",t.s3DiskConfigData.selected_driver)}return{v$:i,diskStore:t,modalStore:e,set_as_default:f,isLoading:s,selected_disk:n,selected_driver:c,is_current_disk:u,loadData:y,submitData:M,onChangeDriver:I,isDisabled:x}}},Ve={class:"px-8 py-6"},qe={key:0,class:"flex items-center mt-6"},xe={class:"relative flex items-center w-12"},Me={class:"ml-4 right"},Ie={class:"p-0 mb-1 text-base leading-snug text-black box-title"};function we(r,a,t,e,d,f){const s=m("BaseInput"),n=m("BaseInputGroup"),u=m("BaseMultiselect"),c=m("BaseInputGrid"),v=m("BaseSwitch");return $(),w("form",{onSubmit:a[15]||(a[15]=z((...i)=>e.submitData&&e.submitData(...i),["prevent"]))},[_("div",Ve,[o(c,null,{default:l(()=>[o(n,{label:r.$t("settings.disk.name"),error:e.v$.s3DiskConfigData.name.$error&&e.v$.s3DiskConfigData.name.$errors[0].$message,required:""},{default:l(()=>[o(s,{modelValue:e.diskStore.s3DiskConfigData.name,"onUpdate:modelValue":a[0]||(a[0]=i=>e.diskStore.s3DiskConfigData.name=i),type:"text",name:"name",invalid:e.v$.s3DiskConfigData.name.$error,onInput:a[1]||(a[1]=i=>e.v$.s3DiskConfigData.name.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),o(n,{label:r.$t("settings.disk.driver"),error:e.v$.s3DiskConfigData.selected_driver.$error&&e.v$.s3DiskConfigData.selected_driver.$errors[0].$message,required:""},{default:l(()=>[o(u,{modelValue:e.selected_driver,"onUpdate:modelValue":[a[2]||(a[2]=i=>e.selected_driver=i),a[3]||(a[3]=i=>e.onChangeDriver(r.data))],invalid:e.v$.s3DiskConfigData.selected_driver.$error,"value-prop":"value",options:t.disks,searchable:"",label:"name","can-deselect":!1},null,8,["modelValue","invalid","options"])]),_:1},8,["label","error"]),o(n,{label:r.$t("settings.disk.aws_root"),error:e.v$.s3DiskConfigData.root.$error&&e.v$.s3DiskConfigData.root.$errors[0].$message,required:""},{default:l(()=>[o(s,{modelValue:e.diskStore.s3DiskConfigData.root,"onUpdate:modelValue":a[4]||(a[4]=i=>e.diskStore.s3DiskConfigData.root=i),modelModifiers:{trim:!0},type:"text",name:"name",placeholder:"Ex. /user/root/",invalid:e.v$.s3DiskConfigData.root.$error,onInput:a[5]||(a[5]=i=>e.v$.s3DiskConfigData.root.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),o(n,{label:r.$t("settings.disk.aws_key"),error:e.v$.s3DiskConfigData.key.$error&&e.v$.s3DiskConfigData.key.$errors[0].$message,required:""},{default:l(()=>[o(s,{modelValue:e.diskStore.s3DiskConfigData.key,"onUpdate:modelValue":a[6]||(a[6]=i=>e.diskStore.s3DiskConfigData.key=i),modelModifiers:{trim:!0},type:"text",name:"name",placeholder:"Ex. KEIS4S39SERSDS",invalid:e.v$.s3DiskConfigData.key.$error,onInput:a[7]||(a[7]=i=>e.v$.s3DiskConfigData.key.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),o(n,{label:r.$t("settings.disk.aws_secret"),error:e.v$.s3DiskConfigData.secret.$error&&e.v$.s3DiskConfigData.secret.$errors[0].$message,required:""},{default:l(()=>[o(s,{modelValue:e.diskStore.s3DiskConfigData.secret,"onUpdate:modelValue":a[8]||(a[8]=i=>e.diskStore.s3DiskConfigData.secret=i),modelModifiers:{trim:!0},type:"text",name:"name",placeholder:"Ex. ********",invalid:e.v$.s3DiskConfigData.secret.$error,onInput:a[9]||(a[9]=i=>e.v$.s3DiskConfigData.secret.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),o(n,{label:r.$t("settings.disk.aws_region"),error:e.v$.s3DiskConfigData.region.$error&&e.v$.s3DiskConfigData.region.$errors[0].$message,required:""},{default:l(()=>[o(s,{modelValue:e.diskStore.s3DiskConfigData.region,"onUpdate:modelValue":a[10]||(a[10]=i=>e.diskStore.s3DiskConfigData.region=i),modelModifiers:{trim:!0},type:"text",name:"name",placeholder:"Ex. us-west",invalid:e.v$.s3DiskConfigData.region.$error,onInput:a[11]||(a[11]=i=>e.v$.s3DiskConfigData.region.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),o(n,{label:r.$t("settings.disk.aws_bucket"),error:e.v$.s3DiskConfigData.bucket.$error&&e.v$.s3DiskConfigData.bucket.$errors[0].$message,required:""},{default:l(()=>[o(s,{modelValue:e.diskStore.s3DiskConfigData.bucket,"onUpdate:modelValue":a[12]||(a[12]=i=>e.diskStore.s3DiskConfigData.bucket=i),modelModifiers:{trim:!0},type:"text",name:"name",placeholder:"Ex. AppName",invalid:e.v$.s3DiskConfigData.bucket.$error,onInput:a[13]||(a[13]=i=>e.v$.s3DiskConfigData.bucket.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"])]),_:1}),e.isDisabled?h("",!0):($(),w("div",qe,[_("div",xe,[o(v,{modelValue:e.set_as_default,"onUpdate:modelValue":a[14]||(a[14]=i=>e.set_as_default=i),class:"flex"},null,8,["modelValue"])]),_("div",Me,[_("p",Ie,q(r.$t("settings.disk.is_default")),1)])]))]),Y(r.$slots,"default",{diskData:{isLoading:e.isLoading,submitData:e.submitData}})],32)}const Ee=j(Be,[["render",we]]),he={props:{isEdit:{type:Boolean,require:!0,default:!1},loading:{type:Boolean,require:!0,default:!1},disks:{type:Array,require:!0,default:Array}},emits:["submit","onChangeDisk"],setup(r,{emit:a}){const t=N(),e=O(),{t:d}=A.useI18n();let f=p(!1),s=p(!1),n=p(null),u=p(null);const c=b({get:()=>t.selected_driver,set:k=>{t.selected_driver=k,t.s3CompatDiskConfigData.selected_driver=k}}),v=b(()=>({s3CompatDiskConfigData:{name:{required:g.withMessage(d("validation.required"),D)},endpoint:{required:g.withMessage(d("validation.required"),D)},root:{required:g.withMessage(d("validation.required"),D)},key:{required:g.withMessage(d("validation.required"),D)},secret:{required:g.withMessage(d("validation.required"),D)},region:{required:g.withMessage(d("validation.required"),D)},bucket:{required:g.withMessage(d("validation.required"),D)},selected_driver:{required:g.withMessage(d("validation.required"),D)}}})),i=T(v,b(()=>t));R(()=>{t.s3CompatDiskConfigData={name:null,selected_driver:"s3compat",key:null,secret:null,region:null,bucket:null,root:null}}),y();async function y(){s.value=!0;let k=L({disk:"s3compat"});if(r.isEdit)Object.assign(t.s3CompatDiskConfigData,e.data),f.value=e.data.set_as_default,f.value&&(u.value=!0);else{let S=await t.fetchDiskEnv(k);Object.assign(t.s3CompatDiskConfigData,S.data)}n.value=r.disks.find(S=>S.value=="s3compat"),s.value=!1}const x=b(()=>!!(r.isEdit&&f.value&&u.value));async function M(){if(i.value.s3CompatDiskConfigData.$touch(),i.value.s3CompatDiskConfigData.$invalid)return!0;let k={credentials:t.s3CompatDiskConfigData,name:t.s3CompatDiskConfigData.name,driver:n.value.value,set_as_default:f.value};return a("submit",k),!1}function I(){a("onChangeDisk",t.s3CompatDiskConfigData.selected_driver)}return{v$:i,diskStore:t,modalStore:e,set_as_default:f,isLoading:s,selected_disk:n,selected_driver:c,is_current_disk:u,loadData:y,submitData:M,onChangeDriver:I,isDisabled:x}}},Ue={class:"px-8 py-6"},Le={key:0,class:"flex items-center mt-6"},Ge={class:"relative flex items-center w-12"},Ne={class:"ml-4 right"},Oe={class:"p-0 mb-1 text-base leading-snug text-black box-title"};function je(r,a,t,e,d,f){const s=m("BaseInput"),n=m("BaseInputGroup"),u=m("BaseMultiselect"),c=m("BaseInputGrid"),v=m("BaseSwitch");return $(),w("form",{onSubmit:a[17]||(a[17]=z((...i)=>e.submitData&&e.submitData(...i),["prevent"]))},[_("div",Ue,[o(c,null,{default:l(()=>[o(n,{label:r.$t("settings.disk.name"),error:e.v$.s3CompatDiskConfigData.name.$error&&e.v$.s3CompatDiskConfigData.name.$errors[0].$message,required:""},{default:l(()=>[o(s,{modelValue:e.diskStore.s3CompatDiskConfigData.name,"onUpdate:modelValue":a[0]||(a[0]=i=>e.diskStore.s3CompatDiskConfigData.name=i),type:"text",name:"name",invalid:e.v$.s3CompatDiskConfigData.name.$error,onInput:a[1]||(a[1]=i=>e.v$.s3CompatDiskConfigData.name.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),o(n,{label:r.$t("settings.disk.driver"),error:e.v$.s3CompatDiskConfigData.selected_driver.$error&&e.v$.s3CompatDiskConfigData.selected_driver.$errors[0].$message,required:""},{default:l(()=>[o(u,{modelValue:e.selected_driver,"onUpdate:modelValue":[a[2]||(a[2]=i=>e.selected_driver=i),a[3]||(a[3]=i=>e.onChangeDriver(r.data))],invalid:e.v$.s3CompatDiskConfigData.selected_driver.$error,"value-prop":"value",options:t.disks,searchable:"",label:"name","can-deselect":!1},null,8,["modelValue","invalid","options"])]),_:1},8,["label","error"]),o(n,{label:r.$t("settings.disk.s3_endpoint"),error:e.v$.s3CompatDiskConfigData.root.$error&&e.v$.s3CompatDiskConfigData.root.$errors[0].$message,required:""},{default:l(()=>[o(s,{modelValue:e.diskStore.s3CompatDiskConfigData.endpoint,"onUpdate:modelValue":a[4]||(a[4]=i=>e.diskStore.s3CompatDiskConfigData.endpoint=i),modelModifiers:{trim:!0},type:"url",name:"endpoint",placeholder:"http://127.0.0.1:9005",invalid:e.v$.s3CompatDiskConfigData.endpoint.$error,onInput:a[5]||(a[5]=i=>e.v$.s3CompatDiskConfigData.endpoint.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),o(n,{label:r.$t("settings.disk.s3_root"),error:e.v$.s3CompatDiskConfigData.root.$error&&e.v$.s3CompatDiskConfigData.root.$errors[0].$message,required:""},{default:l(()=>[o(s,{modelValue:e.diskStore.s3CompatDiskConfigData.root,"onUpdate:modelValue":a[6]||(a[6]=i=>e.diskStore.s3CompatDiskConfigData.root=i),modelModifiers:{trim:!0},type:"text",name:"root",placeholder:"Ex. /user/root/",invalid:e.v$.s3CompatDiskConfigData.root.$error,onInput:a[7]||(a[7]=i=>e.v$.s3CompatDiskConfigData.root.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),o(n,{label:r.$t("settings.disk.s3_key"),error:e.v$.s3CompatDiskConfigData.key.$error&&e.v$.s3CompatDiskConfigData.key.$errors[0].$message,required:""},{default:l(()=>[o(s,{modelValue:e.diskStore.s3CompatDiskConfigData.key,"onUpdate:modelValue":a[8]||(a[8]=i=>e.diskStore.s3CompatDiskConfigData.key=i),modelModifiers:{trim:!0},type:"text",name:"key",placeholder:"Ex. KEIS4S39SERSDS",invalid:e.v$.s3CompatDiskConfigData.key.$error,onInput:a[9]||(a[9]=i=>e.v$.s3CompatDiskConfigData.key.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),o(n,{label:r.$t("settings.disk.s3_secret"),error:e.v$.s3CompatDiskConfigData.secret.$error&&e.v$.s3CompatDiskConfigData.secret.$errors[0].$message,required:""},{default:l(()=>[o(s,{modelValue:e.diskStore.s3CompatDiskConfigData.secret,"onUpdate:modelValue":a[10]||(a[10]=i=>e.diskStore.s3CompatDiskConfigData.secret=i),modelModifiers:{trim:!0},type:"text",name:"secret",placeholder:"Ex. ********",invalid:e.v$.s3CompatDiskConfigData.secret.$error,onInput:a[11]||(a[11]=i=>e.v$.s3CompatDiskConfigData.secret.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),o(n,{label:r.$t("settings.disk.s3_region"),error:e.v$.s3CompatDiskConfigData.region.$error&&e.v$.s3CompatDiskConfigData.region.$errors[0].$message,required:""},{default:l(()=>[o(s,{modelValue:e.diskStore.s3CompatDiskConfigData.region,"onUpdate:modelValue":a[12]||(a[12]=i=>e.diskStore.s3CompatDiskConfigData.region=i),modelModifiers:{trim:!0},type:"text",name:"region",placeholder:"Ex. us-west",invalid:e.v$.s3CompatDiskConfigData.region.$error,onInput:a[13]||(a[13]=i=>e.v$.s3CompatDiskConfigData.region.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),o(n,{label:r.$t("settings.disk.s3_bucket"),error:e.v$.s3CompatDiskConfigData.bucket.$error&&e.v$.s3CompatDiskConfigData.bucket.$errors[0].$message,required:""},{default:l(()=>[o(s,{modelValue:e.diskStore.s3CompatDiskConfigData.bucket,"onUpdate:modelValue":a[14]||(a[14]=i=>e.diskStore.s3CompatDiskConfigData.bucket=i),modelModifiers:{trim:!0},type:"text",name:"bucket",placeholder:"Ex. AppName",invalid:e.v$.s3CompatDiskConfigData.bucket.$error,onInput:a[15]||(a[15]=i=>e.v$.s3CompatDiskConfigData.bucket.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"])]),_:1}),e.isDisabled?h("",!0):($(),w("div",Le,[_("div",Ge,[o(v,{modelValue:e.set_as_default,"onUpdate:modelValue":a[16]||(a[16]=i=>e.set_as_default=i),class:"flex"},null,8,["modelValue"])]),_("div",Ne,[_("p",Oe,q(r.$t("settings.disk.is_default")),1)])]))]),Y(r.$slots,"default",{diskData:{isLoading:e.isLoading,submitData:e.submitData}})],32)}const Ae=j(he,[["render",je]]),Fe={props:{isEdit:{type:Boolean,require:!0,default:!1},loading:{type:Boolean,require:!0,default:!1},disks:{type:Array,require:!0,default:Array}},emits:["submit","onChangeDisk"],setup(r,{emit:a}){const t=N(),e=O(),{t:d}=A.useI18n();let f=p(!1),s=p(!1),n=p(""),u=p(null);const c=b({get:()=>t.selected_driver,set:k=>{t.selected_driver=k,t.doSpaceDiskConfig.selected_driver=k}}),v=b(()=>({doSpaceDiskConfig:{root:{required:g.withMessage(d("validation.required"),D)},key:{required:g.withMessage(d("validation.required"),D)},secret:{required:g.withMessage(d("validation.required"),D)},region:{required:g.withMessage(d("validation.required"),D)},endpoint:{required:g.withMessage(d("validation.required"),D),url:g.withMessage(d("validation.invalid_url"),ae)},bucket:{required:g.withMessage(d("validation.required"),D)},selected_driver:{required:g.withMessage(d("validation.required"),D)},name:{required:g.withMessage(d("validation.required"),D)}}})),i=T(v,b(()=>t));R(()=>{t.doSpaceDiskConfig={name:null,selected_driver:"doSpaces",key:null,secret:null,region:null,bucket:null,endpoint:null,root:null}}),y();async function y(){f.value=!0;let k=L({disk:"doSpaces"});if(r.isEdit)Object.assign(t.doSpaceDiskConfig,JSON.parse(e.data.credentials)),s.value=e.data.set_as_default,s.value&&(u.value=!0);else{let S=await t.fetchDiskEnv(k);Object.assign(t.doSpaceDiskConfig,S.data)}n.value=r.disks.find(S=>S.value=="doSpaces"),f.value=!1}const x=b(()=>!!(r.isEdit&&s.value&&u.value));async function M(){if(i.value.doSpaceDiskConfig.$touch(),i.value.doSpaceDiskConfig.$invalid)return!0;let k={credentials:t.doSpaceDiskConfig,name:t.doSpaceDiskConfig.name,driver:n.value.value,set_as_default:s.value};return a("submit",k),!1}function I(){a("onChangeDisk",t.doSpaceDiskConfig.selected_driver)}return{v$:i,diskStore:t,selected_driver:c,isLoading:f,set_as_default:s,selected_disk:n,is_current_disk:u,loadData:y,submitData:M,onChangeDriver:I,isDisabled:x}}},Te={class:"px-8 py-6"},Re={key:0,class:"flex items-center mt-6"},Ye={class:"relative flex items-center w-12"},ze={class:"ml-4 right"},Ke={class:"p-0 mb-1 text-base leading-snug text-black box-title"};function Pe(r,a,t,e,d,f){const s=m("BaseInput"),n=m("BaseInputGroup"),u=m("BaseMultiselect"),c=m("BaseInputGrid"),v=m("BaseSwitch");return $(),w("form",{onSubmit:a[17]||(a[17]=z((...i)=>e.submitData&&e.submitData(...i),["prevent"]))},[_("div",Te,[o(c,null,{default:l(()=>[o(n,{label:r.$t("settings.disk.name"),error:e.v$.doSpaceDiskConfig.name.$error&&e.v$.doSpaceDiskConfig.name.$errors[0].$message,required:""},{default:l(()=>[o(s,{modelValue:e.diskStore.doSpaceDiskConfig.name,"onUpdate:modelValue":a[0]||(a[0]=i=>e.diskStore.doSpaceDiskConfig.name=i),type:"text",name:"name",invalid:e.v$.doSpaceDiskConfig.name.$error,onInput:a[1]||(a[1]=i=>e.v$.doSpaceDiskConfig.name.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),o(n,{label:r.$t("settings.disk.driver"),error:e.v$.doSpaceDiskConfig.selected_driver.$error&&e.v$.doSpaceDiskConfig.selected_driver.$errors[0].$message,required:""},{default:l(()=>[o(u,{modelValue:e.selected_driver,"onUpdate:modelValue":[a[2]||(a[2]=i=>e.selected_driver=i),a[3]||(a[3]=i=>e.onChangeDriver(r.data))],invalid:e.v$.doSpaceDiskConfig.selected_driver.$error,"value-prop":"value",options:t.disks,searchable:"",label:"name","can-deselect":!1,"track-by":"name"},null,8,["modelValue","invalid","options"])]),_:1},8,["label","error"]),o(n,{label:r.$t("settings.disk.do_spaces_root"),error:e.v$.doSpaceDiskConfig.root.$error&&e.v$.doSpaceDiskConfig.root.$errors[0].$message,required:""},{default:l(()=>[o(s,{modelValue:e.diskStore.doSpaceDiskConfig.root,"onUpdate:modelValue":a[4]||(a[4]=i=>e.diskStore.doSpaceDiskConfig.root=i),modelModifiers:{trim:!0},type:"text",name:"name",placeholder:"Ex. /user/root/",invalid:e.v$.doSpaceDiskConfig.root.$error,onInput:a[5]||(a[5]=i=>e.v$.doSpaceDiskConfig.root.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),o(n,{label:r.$t("settings.disk.do_spaces_key"),error:e.v$.doSpaceDiskConfig.key.$error&&e.v$.doSpaceDiskConfig.key.$errors[0].$message,required:""},{default:l(()=>[o(s,{modelValue:e.diskStore.doSpaceDiskConfig.key,"onUpdate:modelValue":a[6]||(a[6]=i=>e.diskStore.doSpaceDiskConfig.key=i),modelModifiers:{trim:!0},type:"text",name:"name",placeholder:"Ex. KEIS4S39SERSDS",invalid:e.v$.doSpaceDiskConfig.key.$error,onInput:a[7]||(a[7]=i=>e.v$.doSpaceDiskConfig.key.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),o(n,{label:r.$t("settings.disk.do_spaces_secret"),error:e.v$.doSpaceDiskConfig.secret.$error&&e.v$.doSpaceDiskConfig.secret.$errors[0].$message,required:""},{default:l(()=>[o(s,{modelValue:e.diskStore.doSpaceDiskConfig.secret,"onUpdate:modelValue":a[8]||(a[8]=i=>e.diskStore.doSpaceDiskConfig.secret=i),modelModifiers:{trim:!0},type:"text",name:"name",placeholder:"Ex. ********",invalid:e.v$.doSpaceDiskConfig.secret.$error,onInput:a[9]||(a[9]=i=>e.v$.doSpaceDiskConfig.secret.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),o(n,{label:r.$t("settings.disk.do_spaces_region"),error:e.v$.doSpaceDiskConfig.region.$error&&e.v$.doSpaceDiskConfig.region.$errors[0].$message,required:""},{default:l(()=>[o(s,{modelValue:e.diskStore.doSpaceDiskConfig.region,"onUpdate:modelValue":a[10]||(a[10]=i=>e.diskStore.doSpaceDiskConfig.region=i),modelModifiers:{trim:!0},type:"text",name:"name",placeholder:"Ex. nyc3",invalid:e.v$.doSpaceDiskConfig.region.$error,onInput:a[11]||(a[11]=i=>e.v$.doSpaceDiskConfig.region.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),o(n,{label:r.$t("settings.disk.do_spaces_endpoint"),error:e.v$.doSpaceDiskConfig.endpoint.$error&&e.v$.doSpaceDiskConfig.endpoint.$errors[0].$message,required:""},{default:l(()=>[o(s,{modelValue:e.diskStore.doSpaceDiskConfig.endpoint,"onUpdate:modelValue":a[12]||(a[12]=i=>e.diskStore.doSpaceDiskConfig.endpoint=i),modelModifiers:{trim:!0},type:"text",name:"name",placeholder:"Ex. https://nyc3.digitaloceanspaces.com",invalid:e.v$.doSpaceDiskConfig.endpoint.$error,onInput:a[13]||(a[13]=i=>e.v$.doSpaceDiskConfig.endpoint.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),o(n,{label:r.$t("settings.disk.do_spaces_bucket"),error:e.v$.doSpaceDiskConfig.bucket.$error&&e.v$.doSpaceDiskConfig.bucket.$errors[0].$message,required:""},{default:l(()=>[o(s,{modelValue:e.diskStore.doSpaceDiskConfig.bucket,"onUpdate:modelValue":a[14]||(a[14]=i=>e.diskStore.doSpaceDiskConfig.bucket=i),modelModifiers:{trim:!0},type:"text",name:"name",placeholder:"Ex. my-new-space",invalid:e.v$.doSpaceDiskConfig.bucket.$error,onInput:a[15]||(a[15]=i=>e.v$.doSpaceDiskConfig.bucket.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"])]),_:1}),e.isDisabled?h("",!0):($(),w("div",Re,[_("div",Ye,[o(v,{modelValue:e.set_as_default,"onUpdate:modelValue":a[16]||(a[16]=i=>e.set_as_default=i),class:"flex"},null,8,["modelValue"])]),_("div",ze,[_("p",Ke,q(r.$t("settings.disk.is_default")),1)])]))]),Y(r.$slots,"default",{diskData:{isLoading:e.isLoading,submitData:e.submitData}})],32)}const He=j(Fe,[["render",Pe]]),Je={components:{Dropbox:De,Local:ye,S3:Ee,S3compat:Ae,DoSpaces:He},setup(){const r=N(),a=O();let t=p(!1),e=p(!1);oe(()=>{a.id&&(e.value=!0)});const d=b(()=>a.active&&a.componentName==="FileDiskModal");function f(v){return v&&(v.diskData.isLoading.value||t.value)}async function s(){t.value=!0;let v=await r.fetchDiskDrivers();e.value?r.selected_driver=a.data.driver:r.selected_driver=v.data.drivers[0].value,t.value=!1}async function n(v){try{Object.assign(r.diskConfigData,v),t.value=!0;let i={id:a.id,...v},y=null;y=await(e.value?r.updateDisk:r.createDisk)(i),a.refreshData(),u()}catch{}finally{t.value=!1}}function u(){a.closeModal()}function c(v){r.selected_driver=v,r.diskConfigData.selected_driver=v}return{isEdit:e,createNewDisk:n,isRequestFire:f,diskStore:r,closeDiskModal:u,loadData:s,diskChange:c,modalStore:a,isLoading:t,modalActive:d}}},Qe={class:"flex justify-between w-full"},Xe={class:"file-disk-modal"},We={class:"z-0 flex justify-end p-4 border-t border-solid border-gray-light"};function Ze(r,a,t,e,d,f){const s=m("BaseIcon"),n=m("BaseButton"),u=m("BaseModal");return $(),G(u,{show:e.modalActive,onClose:e.closeDiskModal,onOpen:e.loadData},{header:l(()=>[_("div",Qe,[U(q(e.modalStore.title)+" ",1),o(s,{name:"XMarkIcon",class:"h-6 w-6 text-gray-500 cursor-pointer",onClick:e.closeDiskModal},null,8,["onClick"])])]),default:l(()=>[_("div",Xe,[($(),G(ie(e.diskStore.selected_driver),{loading:e.isLoading,disks:e.diskStore.getDiskDrivers,"is-edit":e.isEdit,onOnChangeDisk:a[0]||(a[0]=c=>e.diskChange(c)),onSubmit:e.createNewDisk},{default:l(c=>[_("div",We,[o(n,{class:"mr-3 text-sm",variant:"primary-outline",type:"button",onClick:e.closeDiskModal},{default:l(()=>[U(q(r.$t("general.cancel")),1)]),_:1},8,["onClick"]),o(n,{loading:e.isRequestFire(c),disabled:e.isRequestFire(c),variant:"primary",type:"submit"},{default:l(()=>[e.isRequestFire(c)?h("",!0):($(),G(s,{key:0,name:"ArrowDownOnSquareIcon",class:"w-6 mr-2"})),U(" "+q(r.$t("general.save")),1)]),_:2},1032,["loading","disabled"])])]),_:1},40,["loading","disks","is-edit","onSubmit"]))])]),_:1},8,["show","onClose","onOpen"])}const ea=j(Je,[["render",Ze]]),aa={class:"inline-block"},ta={__name:"FileDiskSetting",setup(r){const a=ne("utils"),t=O(),e=N(),d=te(),f=re(),{t:s}=A.useI18n();let n=p(!1),u=p("");const c=b(()=>[{key:"name",label:s("settings.disk.disk_name"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"driver",label:s("settings.disk.filesystem_driver"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"type",label:s("settings.disk.disk_type"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"set_as_default",label:s("settings.disk.is_default"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"actions",label:"",tdClass:"text-right text-sm font-medium",sortable:!1}]),v=p(d.selectedCompanySettings.save_pdf_to_disk),i=b({get:()=>v.value==="YES",set:async C=>{const E=C?"YES":"NO";let V={settings:{save_pdf_to_disk:E}};v.value=E,await d.updateCompanySettings({data:V,message:"general.setting_updated"})}});async function y({page:C,filter:E,sort:V}){let K=L({orderByField:V.fieldName||"created_at",orderBy:V.order||"desc",page:C}),F=await e.fetchDisks(K);return{data:F.data.data,pagination:{totalPages:F.data.meta.last_page,currentPage:C,totalCount:F.data.meta.total}}}function x(C){return C.set_as_default?!(C.type=="SYSTEM"&&C.set_as_default):!0}function M(){t.openModal({title:s("settings.disk.new_disk"),componentName:"FileDiskModal",variant:"lg",refreshData:u.value&&u.value.refresh})}function I(C){t.openModal({title:s("settings.disk.edit_file_disk"),componentName:"FileDiskModal",variant:"lg",id:C.id,data:C,refreshData:u.value&&u.value.refresh})}function k(C){f.openDialog({title:s("general.are_you_sure"),message:s("settings.disk.set_default_disk_confirm"),yesLabel:s("general.ok"),noLabel:s("general.cancel"),variant:"primary",hideNoButton:!1,size:"lg"}).then(async E=>{if(E){n.value=!0;let V=L({set_as_default:!0,id:C});await e.updateDisk(V).then(()=>{u.value&&u.value.refresh()})}})}function S(C){f.openDialog({title:s("general.are_you_sure"),message:s("settings.disk.confirm_delete"),yesLabel:s("general.ok"),noLabel:s("general.cancel"),variant:"danger",hideNoButton:!1,size:"lg"}).then(async E=>{if(E&&(await e.deleteFileDisk(C)).data.success)return u.value&&u.value.refresh(),!0})}return(C,E)=>{const V=m("BaseIcon"),K=m("BaseButton"),F=m("BaseBadge"),P=m("BaseDropdownItem"),Q=m("BaseDropdown"),X=m("BaseTable"),W=m("BaseDivider"),Z=m("BaseSwitchSection"),ee=m("BaseSettingCard");return $(),w(se,null,[o(ea),o(ee,{title:C.$t("settings.disk.title",1),description:C.$t("settings.disk.description")},{action:l(()=>[o(K,{variant:"primary-outline",onClick:M},{left:l(B=>[o(V,{class:le(B.class),name:"PlusIcon"},null,8,["class"])]),default:l(()=>[U(" "+q(C.$t("settings.disk.new_disk")),1)]),_:1})]),default:l(()=>[o(X,{ref_key:"table",ref:u,class:"mt-16",data:y,columns:c.value},{"cell-set_as_default":l(({row:B})=>[o(F,{"bg-color":J(a).getBadgeStatusColor(B.data.set_as_default?"YES":"NO").bgColor,color:J(a).getBadgeStatusColor(B.data.set_as_default?"YES":"NO").color},{default:l(()=>[U(q(B.data.set_as_default?C.$t("general.yes"):C.$t("general.no").replace("_"," ")),1)]),_:2},1032,["bg-color","color"])]),"cell-actions":l(({row:B})=>[x(B.data)?($(),G(Q,{key:0},{activator:l(()=>[_("div",aa,[o(V,{name:"EllipsisHorizontalIcon",class:"text-gray-500"})])]),default:l(()=>[B.data.set_as_default?h("",!0):($(),G(P,{key:0,onClick:H=>k(B.data.id)},{default:l(()=>[o(V,{class:"mr-3 tetx-gray-600",name:"CheckCircleIcon"}),U(" "+q(C.$t("settings.disk.set_default_disk")),1)]),_:2},1032,["onClick"])),B.data.type!=="SYSTEM"?($(),G(P,{key:1,onClick:H=>I(B.data)},{default:l(()=>[o(V,{name:"PencilIcon",class:"mr-3 text-gray-600"}),U(" "+q(C.$t("general.edit")),1)]),_:2},1032,["onClick"])):h("",!0),B.data.type!=="SYSTEM"&&!B.data.set_as_default?($(),G(P,{key:2,onClick:H=>S(B.data.id)},{default:l(()=>[o(V,{name:"TrashIcon",class:"mr-3 text-gray-600"}),U(" "+q(C.$t("general.delete")),1)]),_:2},1032,["onClick"])):h("",!0)]),_:2},1024)):h("",!0)]),_:1},8,["columns"]),o(W,{class:"mt-8 mb-2"}),o(Z,{modelValue:i.value,"onUpdate:modelValue":E[0]||(E[0]=B=>i.value=B),title:C.$t("settings.disk.save_pdf_to_disk"),description:C.$t("settings.disk.disk_setting_description")},null,8,["modelValue","title","description"])]),_:1},8,["title","description"])],64)}}};export{ta as default};
