import{a6 as $e,F as ee,s as G,a3 as T,e as M,k as K,K as U,w as c,r as h,o as S,b as q,ae,a,l as e,p as te,q as L,t as k,M as A,af as ne,j as z,L as E,c as P,Q as re,R as se,v as W,a9 as fe,I as J,f as y,a7 as ie,g as B,i as j,a$ as H,aH as de,m as x,as as oe,a0 as ue,u as me,a5 as ce,h as Q,O as pe,a2 as we,aj as he,J as ye,H as _e,ah as ge,n as be,b0 as Ie}from"./main-DnObvGgc.js";import{u as X}from"./mail-driver-DqYWSwW8.js";const Y=(i=!1)=>{const C=i?window.pinia.defineStore:$e,{global:D}=window.i18n,r=ee();return C({id:"installation",state:()=>({currentDataBaseData:{database_connection:"mysql",database_hostname:"127.0.0.1",database_port:"3306",database_name:null,database_username:null,database_password:null,database_overwrite:!1,app_url:window.location.origin,app_locale:null}}),actions:{fetchInstallationLanguages(){return new Promise((u,l)=>{G.get("/api/v1/installation/languages").then(d=>{u(d)}).catch(d=>{T(d),l(d)})})},fetchInstallationRequirements(){return new Promise((u,l)=>{G.get("/api/v1/installation/requirements").then(d=>{u(d)}).catch(d=>{T(d),l(d)})})},fetchInstallationStep(){return new Promise((u,l)=>{G.get("/api/v1/installation/wizard-step").then(d=>{u(d)}).catch(d=>{T(d),l(d)})})},addInstallationStep(u){return new Promise((l,d)=>{G.post("/api/v1/installation/wizard-step",u).then(n=>{l(n)}).catch(n=>{T(n),d(n)})})},addInstallationLanguage(u){return new Promise((l,d)=>{G.post("/api/v1/installation/wizard-language",u).then(n=>{l(n)}).catch(n=>{T(n),d(n)})})},fetchInstallationPermissions(){return new Promise((u,l)=>{G.get("/api/v1/installation/permissions").then(d=>{u(d)}).catch(d=>{T(d),l(d)})})},fetchInstallationDatabase(u){return new Promise((l,d)=>{G.get("/api/v1/installation/database/config",{params:u}).then(n=>{l(n)}).catch(n=>{T(n),d(n)})})},addInstallationDatabase(u){return new Promise((l,d)=>{G.post("/api/v1/installation/database/config",u).then(n=>{l(n)}).catch(n=>{T(n),d(n)})})},addInstallationFinish(){return new Promise((u,l)=>{G.post("/api/v1/installation/finish").then(d=>{u(d)}).catch(d=>{T(d),l(d)})})},setInstallationDomain(u){return new Promise((l,d)=>{G.put("/api/v1/installation/set-domain",u).then(n=>{l(n)}).catch(n=>{T(n),d(n)})})},installationLogin(){return new Promise((u,l)=>{G.get("/sanctum/csrf-cookie").then(d=>{d&&G.post("/api/v1/installation/login").then(n=>{r.setSelectedCompany(n.data.company),u(n)}).catch(n=>{T(n),l(n)})})})},checkAuthenticated(){return new Promise((u,l)=>{G.get("/api/v1/auth/check").then(d=>{u(d)}).catch(d=>{l(d)})})}}})()},qe={class:"w-full"},Ve={class:"mb-6"},Be={__name:"Step0SetLanguage",emits:["next"],setup(i,{emit:C}){const D=C;let r=M(!1),u=M(!1),l=M(!1),d=M([]),n="en";const g=Y();K(()=>{s()});async function s(){r.value=!0;const _=await g.fetchInstallationLanguages();d.value=_.data.languages,r.value=!1}function f(){u.value=!0,D("next"),u.value=!1}async function o(_){if(_){l.value=!0;try{await window.loadLanguage(_),n.value=_}catch(t){console.error("Failed to change language:",t)}finally{l.value=!1}}}return(_,t)=>{const m=h("BaseMultiselect"),b=h("BaseInputGroup"),V=h("BaseIcon"),$=h("BaseButton"),v=h("BaseWizardStep");return S(),U(v,{title:_.$t("wizard.install_language.title"),description:_.$t("wizard.install_language.description")},{default:c(()=>[q("div",qe,[q("div",Ve,[a(b,{label:_.$t("wizard.language"),"content-loading":e(r),required:""},{default:c(()=>[a(m,{modelValue:e(n),"onUpdate:modelValue":t[0]||(t[0]=w=>te(n)?n.value=w:n=w),"content-loading":e(r),options:e(d),label:"name","value-prop":"code",placeholder:_.$t("settings.preferences.select_language"),class:"w-full","track-by":"name",searchable:!0,onChange:o},null,8,["modelValue","content-loading","options","placeholder"])]),_:1},8,["label","content-loading"])]),ae(a($,{loading:e(l),disabled:e(l),onClick:f},{left:c(w=>[a(V,{name:"ArrowRightIcon",class:A(w.class)},null,8,["class"])]),default:c(()=>[L(k(_.$t("wizard.continue"))+" ",1)]),_:1},8,["loading","disabled"]),[[ne,!e(r)]])])]),_:1},8,["title","description"])}}},Ce={class:"w-full"},De={class:"mb-6"},Se={key:0,class:"grid grid-flow-row grid-cols-3 p-3 border border-gray-200 lg:gap-24 sm:gap-4"},Fe={class:"col-span-2 text-sm"},Me={class:"text-right"},ze={key:0,class:"inline-block w-4 h-4 ml-3 mr-2 bg-green-500 rounded-full"},ke={key:1,class:"inline-block w-4 h-4 ml-3 mr-2 bg-red-500 rounded-full"},Ue={key:1},Pe={class:"col-span-2 text-sm"},Le={class:"text-right"},Oe={key:0,class:"inline-block w-4 h-4 ml-3 mr-2 bg-green-500 rounded-full"},Ne={key:1,class:"inline-block w-4 h-4 ml-3 mr-2 bg-red-500 rounded-full"},Ge={__name:"Step1RequirementsCheck",emits:["next"],setup(i,{emit:C}){const D=C,r=M(""),u=M(""),l=M(!1);M(!0);const d=Y();K(async()=>{g()});const n=z(()=>{if(r.value){let f=!0;for(const o in r.value)return r.value[o]||(f=!1),r.value&&u.value.supported&&f}return!1});async function g(){var o,_,t,m;l.value=!0;const f=await d.fetchInstallationRequirements();f.data&&(r.value=(t=(_=(o=f==null?void 0:f.data)==null?void 0:o.requirements)==null?void 0:_.requirements)==null?void 0:t.php,u.value=(m=f==null?void 0:f.data)==null?void 0:m.phpSupportInfo)}function s(){l.value=!0,D("next"),l.value=!1}return(f,o)=>{const _=h("BaseIcon"),t=h("BaseButton"),m=h("BaseWizardStep");return S(),U(m,{title:f.$t("wizard.req.system_req"),description:f.$t("wizard.req.system_req_desc")},{default:c(()=>[q("div",Ce,[q("div",De,[u.value?(S(),P("div",Se,[q("div",Fe,k(f.$t("wizard.req.php_req_version",{version:u.value.minimum})),1),q("div",Me,[L(k(u.value.current)+" ",1),u.value.supported?(S(),P("span",ze)):(S(),P("span",ke))])])):E("",!0),r.value?(S(),P("div",Ue,[(S(!0),P(re,null,se(r.value,(b,V)=>(S(),P("div",{key:V,class:"grid grid-flow-row grid-cols-3 p-3 border border-gray-200 lg:gap-24 sm:gap-4"},[q("div",Pe,k(V),1),q("div",Le,[b?(S(),P("span",Oe)):(S(),P("span",Ne))])]))),128))])):E("",!0)]),n.value?(S(),U(t,{key:0,onClick:s},{left:c(b=>[a(_,{name:"ArrowRightIcon",class:A(b.class)},null,8,["class"])]),default:c(()=>[L(k(f.$t("wizard.continue"))+" ",1)]),_:1})):E("",!0),r.value?E("",!0):(S(),U(t,{key:1,loading:l.value,disabled:l.value,onClick:g},{default:c(()=>[L(k(f.$t("wizard.req.check_req")),1)]),_:1},8,["loading","disabled"]))])]),_:1},8,["title","description"])}}},Ee={key:1,class:"relative"},Ae={class:"grid grid-flow-row grid-cols-3 lg:gap-24 sm:gap-4"},We={class:"col-span-2 p-3"},Re={class:"p-3 text-right"},Te={key:0,class:"inline-block w-4 h-4 ml-3 mr-2 rounded-full bg-green-500"},je={key:1,class:"inline-block w-4 h-4 ml-3 mr-2 rounded-full bg-red-500"},xe={__name:"Step2PermissionCheck",emits:["next"],setup(i,{emit:C}){const D=C;let r=M(!1),u=M(!1),l=M([]);const{tm:d,t:n}=W.useI18n(),g=Y(),s=fe();K(()=>{f()});async function f(){r.value=!0;const _=await g.fetchInstallationPermissions();l.value=_.data.permissions.permissions,_.data&&_.data.permissions.errors&&setTimeout(()=>{s.openDialog({title:d("wizard.permissions.permission_confirm_title"),message:n("wizard.permissions.permission_confirm_desc"),yesLabel:"OK",noLabel:"Cancel",variant:"danger",hideNoButton:!1,size:"lg"}).then(t=>{t.data&&(r.value=!1)})},500),r.value=!1}function o(){u.value=!0,D("next"),u.value=!1}return(_,t)=>{const m=h("BaseContentPlaceholdersText"),b=h("BaseContentPlaceholdersBox"),V=h("BaseContentPlaceholders"),$=h("BaseIcon"),v=h("BaseButton"),w=h("BaseWizardStep");return S(),U(w,{title:_.$t("wizard.permissions.permissions"),description:_.$t("wizard.permissions.permission_desc")},{default:c(()=>[e(r)?(S(),U(V,{key:0},{default:c(()=>[(S(),P(re,null,se(3,(p,I)=>q("div",{key:I,class:"grid grid-flow-row grid-cols-3 lg:gap-24 sm:gap-4 border border-gray-200"},[a(m,{lines:1,class:"col-span-4 p-3"})])),64)),a(b,{rounded:!0,class:"mt-10",style:{width:"96px",height:"42px"}})]),_:1})):(S(),P("div",Ee,[(S(!0),P(re,null,se(e(l),(p,I)=>(S(),P("div",{key:I,class:"border border-gray-200"},[q("div",Ae,[q("div",We,k(p.folder),1),q("div",Re,[p.isSet?(S(),P("span",Te)):(S(),P("span",je)),q("span",null,k(p.permission),1)])])]))),128)),ae(a(v,{class:"mt-10",loading:e(u),disabled:e(u),onClick:o},{left:c(p=>[a($,{name:"ArrowRightIcon",class:A(p.class)},null,8,["class"])]),default:c(()=>[L(" "+k(_.$t("wizard.continue")),1)]),_:1},8,["loading","disabled"]),[[ne,!e(r)]])]))]),_:1},8,["title","description"])}}},Je={class:"grid grid-cols-1 gap-5 md:grid-cols-2 mb-6"},Ye={class:"w-full"},He={__name:"MysqlDatabase",props:{configData:{type:Object,require:!0,default:Object},isSaving:{type:Boolean,require:!0,default:!1},isFetchingInitialData:{type:Boolean,default:!1}},emits:["submit-data","on-change-driver"],setup(i,{emit:C}){const D=i,r=C,u=J(["sqlite","mysql","pgsql"]),{t:l}=W.useI18n(),d=ie("utils"),n=Y();K(()=>{for(const m in g.value)D.configData.hasOwnProperty(m)&&(g.value[m]=D.configData[m])});const g=z(()=>n.currentDataBaseData),s=m=>d.checkValidUrl(m),f={database_connection:{required:y.withMessage(l("validation.required"),B)},database_hostname:{required:y.withMessage(l("validation.required"),B)},database_port:{required:y.withMessage(l("validation.required"),B),numeric:oe},database_name:{required:y.withMessage(l("validation.required"),B)},database_username:{required:y.withMessage(l("validation.required"),B)},app_url:{required:y.withMessage(l("validation.required"),B),isUrl:y.withMessage(l("validation.invalid_url"),s)}},o=j(f,g.value);function _(){if(o.value.$touch(),o.value.$invalid)return!0;r("submit-data",g.value)}function t(){o.value.database_connection.$touch(),r("on-change-driver",g.value.database_connection)}return(m,b)=>{const V=h("BaseInput"),$=h("BaseMultiselect"),v=h("BaseIcon"),w=h("BaseButton");return S(),P("form",{action:"",onSubmit:x(_,["prevent"])},[q("div",Je,[a(H,{label:m.$t("wizard.database.app_url"),error:e(o).app_url.$error&&e(o).app_url.$errors[0].$message,required:""},{default:c(()=>[a(V,{modelValue:g.value.app_url,"onUpdate:modelValue":b[0]||(b[0]=p=>g.value.app_url=p),invalid:e(o).app_url.$error,type:"text"},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),a(H,{label:m.$t("wizard.database.connection"),error:e(o).database_connection.$error&&e(o).database_connection.$errors[0].$message,required:""},{default:c(()=>[a($,{modelValue:g.value.database_connection,"onUpdate:modelValue":[b[1]||(b[1]=p=>g.value.database_connection=p),t],invalid:e(o).database_connection.$error,options:u,"can-deselect":!1,"can-clear":!1},null,8,["modelValue","invalid","options"])]),_:1},8,["label","error"]),a(H,{label:m.$t("wizard.database.port"),error:e(o).database_port.$error&&e(o).database_port.$errors[0].$message,required:""},{default:c(()=>[a(V,{modelValue:g.value.database_port,"onUpdate:modelValue":b[2]||(b[2]=p=>g.value.database_port=p),invalid:e(o).database_port.$error},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),a(H,{label:m.$t("wizard.database.db_name"),error:e(o).database_name.$error&&e(o).database_name.$errors[0].$message,required:""},{default:c(()=>[a(V,{modelValue:g.value.database_name,"onUpdate:modelValue":b[3]||(b[3]=p=>g.value.database_name=p),invalid:e(o).database_name.$error},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),a(H,{label:m.$t("wizard.database.username"),error:e(o).database_username.$error&&e(o).database_username.$errors[0].$message,required:""},{default:c(()=>[a(V,{modelValue:g.value.database_username,"onUpdate:modelValue":b[4]||(b[4]=p=>g.value.database_username=p),invalid:e(o).database_username.$error},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),a(H,{label:m.$t("wizard.database.password")},{default:c(()=>[a(V,{modelValue:g.value.database_password,"onUpdate:modelValue":b[5]||(b[5]=p=>g.value.database_password=p),type:"password"},null,8,["modelValue"])]),_:1},8,["label"]),a(H,{label:m.$t("wizard.database.host"),error:e(o).database_hostname.$error&&e(o).database_hostname.$errors[0].$message,required:""},{default:c(()=>[a(V,{modelValue:g.value.database_hostname,"onUpdate:modelValue":b[6]||(b[6]=p=>g.value.database_hostname=p),invalid:e(o).database_hostname.$error},null,8,["modelValue","invalid"])]),_:1},8,["label","error"])]),q("div",Ye,[a(de,{modelValue:g.value.database_overwrite,"onUpdate:modelValue":b[7]||(b[7]=p=>g.value.database_overwrite=p),label:m.$t("wizard.database.overwrite")},null,8,["modelValue","label"])]),a(w,{type:"submit",class:"mt-4",loading:i.isSaving,disabled:i.isSaving},{left:c(p=>[i.isSaving?E("",!0):(S(),U(v,{key:0,name:"ArrowDownOnSquareIcon",class:A(p.class)},null,8,["class"]))]),default:c(()=>[L(" "+k(m.$t("wizard.save_cont")),1)]),_:1},8,["loading","disabled"])],32)}}},Ke={class:"grid grid-cols-1 gap-5 md:grid-cols-2 mb-6"},Ze={class:"w-full"},Qe={__name:"PgsqlDatabase",props:{configData:{type:Object,require:!0,default:Object},isSaving:{type:Boolean,require:!0,default:!1},isFetchingInitialData:{type:Boolean,require:!0,default:!1}},emits:["submit-data","on-change-driver"],setup(i,{emit:C}){const D=i,r=C,u=J(["sqlite","mysql","pgsql"]),{t:l}=W.useI18n(),d=ie("utils"),n=Y(),g=z(()=>n.currentDataBaseData);K(()=>{for(const m in g.value)D.configData.hasOwnProperty(m)&&(g.value[m]=D.configData[m])});const s=m=>d.checkValidUrl(m),f={database_connection:{required:y.withMessage(l("validation.required"),B)},database_hostname:{required:y.withMessage(l("validation.required"),B)},database_port:{required:y.withMessage(l("validation.required"),B),numeric:oe},database_name:{required:y.withMessage(l("validation.required"),B)},database_username:{required:y.withMessage(l("validation.required"),B)},app_url:{required:y.withMessage(l("validation.required"),B),isUrl:y.withMessage(l("validation.invalid_url"),s)}},o=j(f,g.value);function _(){if(o.value.$touch(),o.value.$invalid)return!0;r("submit-data",g.value)}function t(){o.value.database_connection.$touch(),r("on-change-driver",g.value.database_connection)}return(m,b)=>{const V=h("BaseInput"),$=h("BaseInputGroup"),v=h("BaseMultiselect"),w=h("BaseIcon"),p=h("BaseButton");return S(),P("form",{action:"",onSubmit:x(_,["prevent"])},[q("div",Ke,[a($,{label:m.$t("wizard.database.app_url"),"content-loading":i.isFetchingInitialData,error:e(o).app_url.$error&&e(o).app_url.$errors[0].$message,required:""},{default:c(()=>[a(V,{modelValue:g.value.app_url,"onUpdate:modelValue":b[0]||(b[0]=I=>g.value.app_url=I),"content-loading":i.isFetchingInitialData,invalid:e(o).app_url.$error,type:"text"},null,8,["modelValue","content-loading","invalid"])]),_:1},8,["label","content-loading","error"]),a($,{label:m.$t("wizard.database.connection"),"content-loading":i.isFetchingInitialData,error:e(o).database_connection.$error&&e(o).database_connection.$errors[0].$message,required:""},{default:c(()=>[a(v,{modelValue:g.value.database_connection,"onUpdate:modelValue":[b[1]||(b[1]=I=>g.value.database_connection=I),t],"content-loading":i.isFetchingInitialData,invalid:e(o).database_connection.$error,options:u,"can-deselect":!1,"can-clear":!1},null,8,["modelValue","content-loading","invalid","options"])]),_:1},8,["label","content-loading","error"]),a($,{label:m.$t("wizard.database.port"),"content-loading":i.isFetchingInitialData,error:e(o).database_port.$error&&e(o).database_port.$errors[0].$message,required:""},{default:c(()=>[a(V,{modelValue:g.value.database_port,"onUpdate:modelValue":b[2]||(b[2]=I=>g.value.database_port=I),"content-loading":i.isFetchingInitialData,invalid:e(o).database_port.$error},null,8,["modelValue","content-loading","invalid"])]),_:1},8,["label","content-loading","error"]),a($,{label:m.$t("wizard.database.db_name"),"content-loading":i.isFetchingInitialData,error:e(o).database_name.$error&&e(o).database_name.$errors[0].$message,required:""},{default:c(()=>[a(V,{modelValue:g.value.database_name,"onUpdate:modelValue":b[3]||(b[3]=I=>g.value.database_name=I),"content-loading":i.isFetchingInitialData,invalid:e(o).database_name.$error},null,8,["modelValue","content-loading","invalid"])]),_:1},8,["label","content-loading","error"]),a($,{label:m.$t("wizard.database.username"),"content-loading":i.isFetchingInitialData,error:e(o).database_username.$error&&e(o).database_username.$errors[0].$message,required:""},{default:c(()=>[a(V,{modelValue:g.value.database_username,"onUpdate:modelValue":b[4]||(b[4]=I=>g.value.database_username=I),"content-loading":i.isFetchingInitialData,invalid:e(o).database_username.$error},null,8,["modelValue","content-loading","invalid"])]),_:1},8,["label","content-loading","error"]),a($,{"content-loading":i.isFetchingInitialData,label:m.$t("wizard.database.password")},{default:c(()=>[a(V,{modelValue:g.value.database_password,"onUpdate:modelValue":b[5]||(b[5]=I=>g.value.database_password=I),"content-loading":i.isFetchingInitialData,type:"password"},null,8,["modelValue","content-loading"])]),_:1},8,["content-loading","label"]),a($,{label:m.$t("wizard.database.host"),"content-loading":i.isFetchingInitialData,error:e(o).database_hostname.$error&&e(o).database_hostname.$errors[0].$message,required:""},{default:c(()=>[a(V,{modelValue:g.value.database_hostname,"onUpdate:modelValue":b[6]||(b[6]=I=>g.value.database_hostname=I),"content-loading":i.isFetchingInitialData,invalid:e(o).database_hostname.$error},null,8,["modelValue","content-loading","invalid"])]),_:1},8,["label","content-loading","error"])]),q("div",Ze,[a(de,{modelValue:g.value.database_overwrite,"onUpdate:modelValue":b[7]||(b[7]=I=>g.value.database_overwrite=I),label:m.$t("wizard.database.overwrite")},null,8,["modelValue","label"])]),ae(a(p,{"content-loading":i.isFetchingInitialData,type:"submit",class:"mt-4",loading:i.isSaving,disabled:i.isSaving},{left:c(I=>[i.isSaving?E("",!0):(S(),U(w,{key:0,name:"ArrowDownOnSquareIcon",class:A(I.class)},null,8,["class"]))]),default:c(()=>[L(" "+k(m.$t("wizard.save_cont")),1)]),_:1},8,["content-loading","loading","disabled"]),[[ne,!i.isFetchingInitialData]])],32)}}},Xe={class:"grid grid-cols-1 gap-5 md:grid-cols-2 mb-6"},ea={class:"w-full"},aa={__name:"SqliteDatabase",props:{configData:{type:Object,require:!0,default:Object},isSaving:{type:Boolean,require:!0,default:!1},isFetchingInitialData:{type:Boolean,require:!0,default:!1}},emits:["submit-data","on-change-driver"],setup(i,{emit:C}){const D=i,r=C,u=J(["sqlite","mysql","pgsql"]),{t:l}=W.useI18n(),d=ie("utils"),n=Y(),g=z(()=>n.currentDataBaseData);K(()=>{for(const m in g.value)D.configData.hasOwnProperty(m)&&(g.value[m]=D.configData[m])});const s=m=>d.checkValidUrl(m),f={database_connection:{required:y.withMessage(l("validation.required"),B)},database_name:{required:y.withMessage(l("validation.required"),B)},app_url:{required:y.withMessage(l("validation.required"),B),isUrl:y.withMessage(l("validation.invalid_url"),s)}},o=j(f,g.value);function _(){if(o.value.$touch(),o.value.$invalid)return!0;r("submit-data",g.value)}function t(){o.value.database_connection.$touch(),r("on-change-driver",g.value.database_connection)}return(m,b)=>{const V=h("BaseInput"),$=h("BaseInputGroup"),v=h("BaseMultiselect"),w=h("BaseIcon"),p=h("BaseButton");return S(),P("form",{action:"",onSubmit:x(_,["prevent"])},[q("div",Xe,[a($,{label:m.$t("wizard.database.app_url"),"content-loading":i.isFetchingInitialData,error:e(o).app_url.$error&&e(o).app_url.$errors[0].$message,required:""},{default:c(()=>[a(V,{modelValue:g.value.app_url,"onUpdate:modelValue":b[0]||(b[0]=I=>g.value.app_url=I),"content-loading":i.isFetchingInitialData,invalid:e(o).app_url.$error,type:"text"},null,8,["modelValue","content-loading","invalid"])]),_:1},8,["label","content-loading","error"]),a($,{label:m.$t("wizard.database.connection"),"content-loading":i.isFetchingInitialData,error:e(o).database_connection.$error&&e(o).database_connection.$errors[0].$message,required:""},{default:c(()=>[a(v,{modelValue:g.value.database_connection,"onUpdate:modelValue":[b[1]||(b[1]=I=>g.value.database_connection=I),t],"content-loading":i.isFetchingInitialData,invalid:e(o).database_connection.$error,options:u,"can-deselect":!1,"can-clear":!1},null,8,["modelValue","content-loading","invalid","options"])]),_:1},8,["label","content-loading","error"]),a($,{label:m.$t("wizard.database.db_path"),error:e(o).database_name.$error&&e(o).database_name.$errors[0].$message,"content-loading":i.isFetchingInitialData,required:""},{default:c(()=>[a(V,{modelValue:g.value.database_name,"onUpdate:modelValue":b[2]||(b[2]=I=>g.value.database_name=I),"content-loading":i.isFetchingInitialData,invalid:e(o).database_name.$error},null,8,["modelValue","content-loading","invalid"])]),_:1},8,["label","error","content-loading"])]),q("div",ea,[a(de,{modelValue:g.value.database_overwrite,"onUpdate:modelValue":b[3]||(b[3]=I=>g.value.database_overwrite=I),label:m.$t("wizard.database.overwrite")},null,8,["modelValue","label"])]),ae(a(p,{"content-loading":i.isFetchingInitialData,type:"submit",class:"mt-4",loading:i.isSaving,disabled:i.isSaving},{left:c(I=>[i.isSaving?E("",!0):(S(),U(w,{key:0,name:"ArrowDownOnSquareIcon",class:A(I.class)},null,8,["class"]))]),default:c(()=>[L(" "+k(m.$t("wizard.save_cont")),1)]),_:1},8,["content-loading","loading","disabled"]),[[ne,!i.isFetchingInitialData]])],32)}}},ta={components:{Mysql:He,Pgsql:Qe,Sqlite:aa},emits:["next"],setup(i,{emit:C}){const D=M("mysql"),r=M(!1),{t:u}=W.useI18n(),{global:l}=window.i18n,d=me(),n=Y(),g=z(()=>(n.currentDataBaseData.app_locale=l.locale.value,n.currentDataBaseData));async function s(o){let _={connection:o};const t=await n.fetchInstallationDatabase(_);t.data.success&&(g.value.database_connection=t.data.config.database_connection),o==="sqlite"?g.value.database_name=t.data.config.database_name:g.value.database_name=null}async function f(o){r.value=!0;try{let _=await n.addInstallationDatabase(o);if(r.value=!1,_.data.success){await n.addInstallationFinish(),C("next",3);let t={profile_language:l.locale.value};await n.addInstallationLanguage(t),d.showNotification({type:"success",message:u("wizard.success."+_.data.success)});return}else if(_.data.error){if(_.data.requirement){d.showNotification({type:"error",message:u("wizard.errors."+_.data.error,{version:_.data.requirement.minimum,name:o.value.database_connection})});return}d.showNotification({type:"error",message:u("wizard.errors."+_.data.error)})}else _.data.errors?d.showNotification({type:"error",message:_.data.errors[0]}):_.data.error_message&&d.showNotification({type:"error",message:_.data.error_message})}catch{d.showNotification({type:"error",message:u("validation.something_went_wrong")}),r.value=!1}finally{r.value=!1}}return{databaseData:g,database_connection:D,isSaving:r,getDatabaseConfig:s,next:f}}};function na(i,C,D,r,u,l){const d=h("BaseWizardStep");return S(),U(d,{title:i.$t("wizard.database.database"),description:i.$t("wizard.database.desc"),"step-container":"w-full p-8 mb-8 bg-white border border-gray-200 border-solid rounded md:w-full"},{default:c(()=>[(S(),U(ce(r.databaseData.database_connection),{"config-data":r.databaseData,"is-saving":r.isSaving,onOnChangeDriver:r.getDatabaseConfig,onSubmitData:r.next},null,40,["config-data","is-saving","onOnChangeDriver","onSubmitData"]))]),_:1},8,["title","description"])}const ia=ue(ta,[["render",na]]),oa={class:"w-full"},la={class:"mt-4 mb-0 text-sm text-gray-600"},ra={class:"w-full text-gray-600 list-disc list-inside"},sa={class:"text-sm leading-8"},da={class:"text-sm leading-8"},ua={__name:"Step4VerifyDomain",emits:["next"],setup(i,{emit:C}){const D=C,r=J({app_domain:window.location.origin.replace(/(^\w+:|^)\/\//,"")}),u=M(!1),{t:l}=W.useI18n(),d=ie("utils"),n=t=>d.checkValidDomainUrl(t),g=Y(),s=me(),f={app_domain:{required:y.withMessage(l("validation.required"),B),isUrl:y.withMessage(l("validation.invalid_domain_url"),n)}},o=j(f,z(()=>r));async function _(){if(o.value.$touch(),o.value.$invalid)return!0;u.value=!0;try{await g.setInstallationDomain(r),await g.installationLogin(),(await g.checkAuthenticated()).data&&D("next",4),u.value=!1}catch{s.showNotification({type:"error",message:l("wizard.verify_domain.failed")}),u.value=!1}}return(t,m)=>{const b=h("BaseInput"),V=h("BaseInputGroup"),$=h("BaseButton"),v=h("BaseWizardStep");return S(),U(v,{title:t.$t("wizard.verify_domain.title"),description:t.$t("wizard.verify_domain.desc")},{default:c(()=>[q("div",oa,[a(V,{label:t.$t("wizard.verify_domain.app_domain"),error:e(o).app_domain.$error&&e(o).app_domain.$errors[0].$message,required:""},{default:c(()=>[a(b,{modelValue:r.app_domain,"onUpdate:modelValue":m[0]||(m[0]=w=>r.app_domain=w),invalid:e(o).app_domain.$error,type:"text",onInput:m[1]||(m[1]=w=>e(o).app_domain.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"])]),q("p",la,k(t.$t("wizard.verify_domain.notes.notes")),1),q("ul",ra,[q("li",sa,[L(k(t.$t("wizard.verify_domain.notes.not_contain"))+" ",1),m[2]||(m[2]=q("b",{class:"inline-block px-1 bg-gray-100 rounded-sm"},"https://",-1)),L(" "+k(t.$t("wizard.verify_domain.notes.or"))+" ",1),m[3]||(m[3]=q("b",{class:"inline-block px-1 bg-gray-100 rounded-sm"},"http",-1)),L(" "+k(t.$t("wizard.verify_domain.notes.in_front")),1)]),q("li",da,[L(k(t.$t("wizard.verify_domain.notes.if_you"))+" ",1),m[4]||(m[4]=q("b",{class:"inline-block px-1 bg-gray-100"},"localhost:8080",-1))])]),a($,{loading:u.value,disabled:u.value,class:"mt-8",onClick:_},{default:c(()=>[L(k(t.$t("wizard.verify_domain.verify_now")),1)]),_:1},8,["loading","disabled"])]),_:1},8,["title","description"])}}},ma={class:"grid grid-cols-1 gap-4 mb-4 md:grid-cols-2 md:mb-6"},ca={class:"grid grid-cols-1 gap-4 mb-4 md:grid-cols-2 md:mb-6"},ga={class:"grid grid-cols-1 gap-4 mb-4 md:grid-cols-2 md:mb-6"},va={class:"grid grid-cols-1 gap-4 mb-6 md:grid-cols-2"},fa={__name:"SmtpMailDriver",props:{isSaving:{type:Boolean,require:!0,default:!1},isFetchingInitialData:{type:Boolean,require:!0,default:!1}},emits:["submit-data","on-change-driver"],setup(i,{emit:C}){const D=C;let r=M(!1);const u=J(["none","tls","ssl","starttls"]),{t:l}=W.useI18n(),d=X(),n=z(()=>d.smtpConfig),g=z(()=>r.value?"text":"password");n.value.mail_driver="smtp";const s=z(()=>({smtpConfig:{mail_driver:{required:y.withMessage(l("validation.required"),B)},mail_host:{required:y.withMessage(l("validation.required"),B)},mail_port:{required:y.withMessage(l("validation.required"),B),numeric:y.withMessage(l("validation.numbers_only"),oe)},mail_encryption:{required:y.withMessage(l("validation.required"),B)},from_mail:{required:y.withMessage(l("validation.required"),B),email:y.withMessage(l("validation.email_incorrect"),Q)},from_name:{required:y.withMessage(l("validation.required"),B)}}})),f=j(s,z(()=>d));async function o(){return f.value.$touch(),f.value.$invalid||D("submit-data",d.smtpConfig),!1}function _(){f.value.smtpConfig.mail_driver.$touch(),D("on-change-driver",d.smtpConfig.mail_driver)}return(t,m)=>{const b=h("BaseMultiselect"),V=h("BaseInputGroup"),$=h("BaseInput"),v=h("BaseIcon"),w=h("BaseButton");return S(),P("form",{onSubmit:x(o,["prevent"])},[q("div",ma,[a(V,{label:t.$t("wizard.mail.driver"),"content-loading":i.isFetchingInitialData,error:e(f).smtpConfig.mail_driver.$error&&e(f).smtpConfig.mail_driver.$errors[0].$message,required:""},{default:c(()=>[a(b,{modelValue:n.value.mail_driver,"onUpdate:modelValue":[m[0]||(m[0]=p=>n.value.mail_driver=p),_],options:e(d).mail_drivers,"can-deselect":!1,"content-loading":i.isFetchingInitialData,invalid:e(f).smtpConfig.mail_driver.$error},null,8,["modelValue","options","content-loading","invalid"])]),_:1},8,["label","content-loading","error"]),a(V,{label:t.$t("wizard.mail.host"),"content-loading":i.isFetchingInitialData,error:e(f).smtpConfig.mail_host.$error&&e(f).smtpConfig.mail_host.$errors[0].$message,required:""},{default:c(()=>[a($,{modelValue:n.value.mail_host,"onUpdate:modelValue":m[1]||(m[1]=p=>n.value.mail_host=p),modelModifiers:{trim:!0},invalid:e(f).smtpConfig.mail_host.$error,"content-loading":i.isFetchingInitialData,type:"text",name:"mail_host",onInput:m[2]||(m[2]=p=>e(f).smtpConfig.mail_host.$touch())},null,8,["modelValue","invalid","content-loading"])]),_:1},8,["label","content-loading","error"])]),q("div",ca,[a(V,{label:t.$t("wizard.mail.username"),"content-loading":i.isFetchingInitialData},{default:c(()=>[a($,{modelValue:n.value.mail_username,"onUpdate:modelValue":m[3]||(m[3]=p=>n.value.mail_username=p),modelModifiers:{trim:!0},"content-loading":i.isFetchingInitialData,type:"text",name:"db_name"},null,8,["modelValue","content-loading"])]),_:1},8,["label","content-loading"]),a(V,{label:t.$t("wizard.mail.password"),"content-loading":i.isFetchingInitialData},{default:c(()=>[a($,{modelValue:n.value.mail_password,"onUpdate:modelValue":m[5]||(m[5]=p=>n.value.mail_password=p),modelModifiers:{trim:!0},type:g.value,"content-loading":i.isFetchingInitialData,autocomplete:"off","data-lpignore":"true",name:"password"},{right:c(()=>[a(v,{name:e(r)?"EyeIcon":"EyeSlashIcon",class:"mr-1 text-gray-500 cursor-pointer",onClick:m[4]||(m[4]=p=>te(r)?r.value=!e(r):r=!e(r))},null,8,["name"])]),_:1},8,["modelValue","type","content-loading"])]),_:1},8,["label","content-loading"])]),q("div",ga,[a(V,{label:t.$t("wizard.mail.port"),error:e(f).smtpConfig.mail_port.$error&&e(f).smtpConfig.mail_port.$errors[0].$message,"content-loading":i.isFetchingInitialData,required:""},{default:c(()=>[a($,{modelValue:n.value.mail_port,"onUpdate:modelValue":m[6]||(m[6]=p=>n.value.mail_port=p),modelModifiers:{trim:!0},invalid:e(f).smtpConfig.mail_port.$error,"content-loading":i.isFetchingInitialData,type:"text",name:"mail_port",onInput:m[7]||(m[7]=p=>e(f).smtpConfig.mail_port.$touch())},null,8,["modelValue","invalid","content-loading"])]),_:1},8,["label","error","content-loading"]),a(V,{label:t.$t("wizard.mail.encryption"),error:e(f).smtpConfig.mail_encryption.$error&&e(f).smtpConfig.mail_encryption.$errors[0].$message,"content-loading":i.isFetchingInitialData,required:""},{default:c(()=>[a(b,{modelValue:n.value.mail_encryption,"onUpdate:modelValue":m[8]||(m[8]=p=>n.value.mail_encryption=p),modelModifiers:{trim:!0},options:u,"can-deselect":!1,invalid:e(f).smtpConfig.mail_encryption.$error,"content-loading":i.isFetchingInitialData,onInput:m[9]||(m[9]=p=>e(f).smtpConfig.mail_encryption.$touch())},null,8,["modelValue","options","invalid","content-loading"])]),_:1},8,["label","error","content-loading"])]),q("div",va,[a(V,{label:t.$t("wizard.mail.from_mail"),error:e(f).smtpConfig.from_mail.$error&&e(f).smtpConfig.from_mail.$errors[0].$message,"content-loading":i.isFetchingInitialData,required:""},{default:c(()=>[a($,{modelValue:n.value.from_mail,"onUpdate:modelValue":m[10]||(m[10]=p=>n.value.from_mail=p),modelModifiers:{trim:!0},invalid:e(f).smtpConfig.from_mail.$error,"content-loading":i.isFetchingInitialData,type:"text",name:"from_mail",onInput:m[11]||(m[11]=p=>e(f).smtpConfig.from_mail.$touch())},null,8,["modelValue","invalid","content-loading"])]),_:1},8,["label","error","content-loading"]),a(V,{label:t.$t("wizard.mail.from_name"),error:e(f).smtpConfig.from_name.$error&&e(f).smtpConfig.from_name.$errors[0].$message,"content-loading":i.isFetchingInitialData,required:""},{default:c(()=>[a($,{modelValue:n.value.from_name,"onUpdate:modelValue":m[12]||(m[12]=p=>n.value.from_name=p),modelModifiers:{trim:!0},invalid:e(f).smtpConfig.from_name.$error,"content-loading":i.isFetchingInitialData,type:"text",name:"from_name",onInput:m[13]||(m[13]=p=>e(f).smtpConfig.from_name.$touch())},null,8,["modelValue","invalid","content-loading"])]),_:1},8,["label","error","content-loading"])]),a(w,{loading:i.isSaving,disabled:i.isSaving,"content-loading":i.isFetchingInitialData,class:"mt-4"},{left:c(p=>[i.isSaving?E("",!0):(S(),U(v,{key:0,name:"ArrowDownOnSquareIcon",class:A(p.class)},null,8,["class"]))]),default:c(()=>[L(" "+k(t.$t("general.save")),1)]),_:1},8,["loading","disabled","content-loading"])],32)}}},pa={class:"grid grid-cols-1 gap-4 mb-4 md:grid-cols-2 lg:mb-6 md:mb-6"},_a={class:"grid grid-cols-1 gap-4 mb-4 md:grid-cols-2 lg:mb-6 md:mb-6"},ba={class:"grid grid-cols-1 gap-4 mb-6 md:grid-cols-2"},$a={__name:"MailgunMailDriver",props:{isSaving:{type:Boolean,require:!0,default:!1},isFetchingInitialData:{type:Boolean,require:!0,default:!1}},emits:["submit-data","on-change-driver"],setup(i,{emit:C}){const D=C;let r=M(!1);const u=X(),{t:l}=W.useI18n(),d=z(()=>u.mailgunConfig),n=z(()=>r.value?"text":"password");d.value.mail_driver="mailgun";const g=z(()=>({mailgunConfig:{mail_driver:{required:y.withMessage(l("validation.required"),B)},mail_mailgun_domain:{required:y.withMessage(l("validation.required"),B)},mail_mailgun_endpoint:{required:y.withMessage(l("validation.required"),B)},mail_mailgun_secret:{required:y.withMessage(l("validation.required"),B)},from_mail:{required:y.withMessage(l("validation.required"),B),email:Q},from_name:{required:y.withMessage(l("validation.required"),B)}}})),s=j(g,z(()=>u));function f(){return s.value.$touch(),s.value.$invalid||D("submit-data",u.mailgunConfig),!1}function o(){s.value.mailgunConfig.mail_driver.$touch(),D("on-change-driver",u.mailgunConfig.mail_driver)}return(_,t)=>{const m=h("BaseMultiselect"),b=h("BaseInputGroup"),V=h("BaseInput"),$=h("BaseIcon"),v=h("BaseButton");return S(),P("form",{onSubmit:x(f,["prevent"])},[q("div",pa,[a(b,{label:_.$t("wizard.mail.driver"),"content-loading":i.isFetchingInitialData,error:e(s).mailgunConfig.mail_driver.$error&&e(s).mailgunConfig.mail_driver.$errors[0].$message,required:""},{default:c(()=>[a(m,{modelValue:d.value.mail_driver,"onUpdate:modelValue":[t[0]||(t[0]=w=>d.value.mail_driver=w),o],options:e(u).mail_drivers,"can-deselect":!1,invalid:e(s).mailgunConfig.mail_driver.$error,"content-loading":i.isFetchingInitialData},null,8,["modelValue","options","invalid","content-loading"])]),_:1},8,["label","content-loading","error"]),a(b,{label:_.$t("wizard.mail.mailgun_domain"),"content-loading":i.isFetchingInitialData,error:e(s).mailgunConfig.mail_mailgun_domain.$error&&e(s).mailgunConfig.mail_mailgun_domain.$errors[0].$message,required:""},{default:c(()=>[a(V,{modelValue:d.value.mail_mailgun_domain,"onUpdate:modelValue":t[1]||(t[1]=w=>d.value.mail_mailgun_domain=w),modelModifiers:{trim:!0},invalid:e(s).mailgunConfig.mail_mailgun_domain.$error,"content-loading":i.isFetchingInitialData,type:"text",name:"mailgun_domain",onInput:t[2]||(t[2]=w=>e(s).mailgunConfig.mail_mailgun_domain.$touch())},null,8,["modelValue","invalid","content-loading"])]),_:1},8,["label","content-loading","error"])]),q("div",_a,[a(b,{label:_.$t("wizard.mail.mailgun_secret"),"content-loading":i.isFetchingInitialData,error:e(s).mailgunConfig.mail_mailgun_secret.$error&&e(s).mailgunConfig.mail_mailgun_secret.$errors[0].$message,required:""},{default:c(()=>[a(V,{modelValue:d.value.mail_mailgun_secret,"onUpdate:modelValue":t[4]||(t[4]=w=>d.value.mail_mailgun_secret=w),modelModifiers:{trim:!0},invalid:e(s).mailgunConfig.mail_mailgun_secret.$error,type:n.value,"content-loading":i.isFetchingInitialData,name:"mailgun_secret",autocomplete:"off","data-lpignore":"true",onInput:t[5]||(t[5]=w=>e(s).mailgunConfig.mail_mailgun_secret.$touch())},{right:c(()=>[a($,{name:e(r)?"EyeIcon":"EyeSlashIcon",class:"mr-1 text-gray-500 cursor-pointer",onClick:t[3]||(t[3]=w=>te(r)?r.value=!e(r):r=!e(r))},null,8,["name"])]),_:1},8,["modelValue","invalid","type","content-loading"])]),_:1},8,["label","content-loading","error"]),a(b,{label:_.$t("wizard.mail.mailgun_endpoint"),"content-loading":i.isFetchingInitialData,error:e(s).mailgunConfig.mail_mailgun_endpoint.$error&&e(s).mailgunConfig.mail_mailgun_endpoint.$errors[0].$message,required:""},{default:c(()=>[a(V,{modelValue:d.value.mail_mailgun_endpoint,"onUpdate:modelValue":t[6]||(t[6]=w=>d.value.mail_mailgun_endpoint=w),modelModifiers:{trim:!0},invalid:e(s).mailgunConfig.mail_mailgun_endpoint.$error,"content-loading":i.isFetchingInitialData,type:"text",name:"mailgun_endpoint",onInput:t[7]||(t[7]=w=>e(s).mailgunConfig.mail_mailgun_endpoint.$touch())},null,8,["modelValue","invalid","content-loading"])]),_:1},8,["label","content-loading","error"])]),q("div",ba,[a(b,{label:_.$t("wizard.mail.from_mail"),"content-loading":i.isFetchingInitialData,error:e(s).mailgunConfig.from_mail.$error&&e(s).mailgunConfig.from_mail.$errors[0].$message,required:""},{default:c(()=>[a(V,{modelValue:d.value.from_mail,"onUpdate:modelValue":t[8]||(t[8]=w=>d.value.from_mail=w),modelModifiers:{trim:!0},name:"from_mail",type:"text",invalid:e(s).mailgunConfig.from_mail.$error,"content-loading":i.isFetchingInitialData,onInput:t[9]||(t[9]=w=>e(s).mailgunConfig.from_mail.$touch())},null,8,["modelValue","invalid","content-loading"])]),_:1},8,["label","content-loading","error"]),a(b,{label:_.$t("wizard.mail.from_name"),"content-loading":i.isFetchingInitialData,error:e(s).mailgunConfig.from_name.$error&&e(s).mailgunConfig.from_name.$errors[0].$message,required:""},{default:c(()=>[a(V,{modelValue:d.value.from_name,"onUpdate:modelValue":t[10]||(t[10]=w=>d.value.from_name=w),modelModifiers:{trim:!0},invalid:e(s).mailgunConfig.from_name.$error,"content-loading":i.isFetchingInitialData,type:"text",name:"from_name",onInput:t[11]||(t[11]=w=>e(s).mailgunConfig.from_name.$touch())},null,8,["modelValue","invalid","content-loading"])]),_:1},8,["label","content-loading","error"])]),a(v,{loading:_.loading,disabled:i.isSaving,"content-loading":i.isFetchingInitialData,class:"mt-4"},{left:c(w=>[i.isSaving?E("",!0):(S(),U($,{key:0,name:"ArrowDownOnSquareIcon",class:A(w.class)},null,8,["class"]))]),default:c(()=>[L(" "+k(_.$t("general.save")),1)]),_:1},8,["loading","disabled","content-loading"])],32)}}},wa={class:"grid grid-cols-1 gap-4 mb-4 md:grid-cols-2 md:mb-6"},ha={class:"grid grid-cols-1 gap-4 mb-4 md:grid-cols-2 md:mb-6"},ya={class:"grid grid-cols-1 gap-4 mb-4 md:grid-cols-2 md:mb-6"},Ia={class:"grid grid-cols-1 gap-4 mb-6 md:grid-cols-2"},qa={__name:"SesMailDriver",props:{isSaving:{type:Boolean,require:!0,default:!1},isFetchingInitialData:{type:Boolean,require:!0,default:!1}},emits:["submit-data","on-change-driver"],setup(i,{emit:C}){const D=C,{t:r}=W.useI18n(),u=J(["tls","ssl","starttls"]);let l=M(!1);const d=X(),n=z(()=>d.sesConfig);n.value.mail_driver="ses";const g=z(()=>({sesConfig:{mail_driver:{required:y.withMessage(r("validation.required"),B)},mail_host:{required:y.withMessage(r("validation.required"),B)},mail_port:{required:y.withMessage(r("validation.required"),B),numeric:oe},mail_ses_key:{required:y.withMessage(r("validation.required"),B)},mail_ses_secret:{required:y.withMessage(r("validation.required"),B)},mail_ses_region:{required:y.withMessage(r("validation.required"),B)},mail_encryption:{required:y.withMessage(r("validation.required"),B)},from_mail:{required:y.withMessage(r("validation.required"),B),email:y.withMessage(r("validation.email_incorrect"),Q)},from_name:{required:y.withMessage(r("validation.required"),B)}}})),s=j(g,z(()=>d));async function f(){return s.value.$touch(),s.value.$invalid||D("submit-data",d.sesConfig),!1}function o(){s.value.sesConfig.mail_driver.$touch(),D("on-change-driver",d.sesConfig.mail_driver)}return(_,t)=>{const m=h("BaseMultiselect"),b=h("BaseInputGroup"),V=h("BaseInput"),$=h("BaseIcon"),v=h("BaseButton");return S(),P("form",{onSubmit:x(f,["prevent"])},[q("div",wa,[a(b,{label:_.$t("wizard.mail.driver"),"content-loading":i.isFetchingInitialData,error:e(s).sesConfig.mail_driver.$error&&e(s).sesConfig.mail_driver.$errors[0].$message,required:""},{default:c(()=>[a(m,{modelValue:n.value.mail_driver,"onUpdate:modelValue":[t[0]||(t[0]=w=>n.value.mail_driver=w),o],options:e(d).mail_drivers,"can-deselect":!1,"content-loading":i.isFetchingInitialData,invalid:e(s).sesConfig.mail_driver.$error},null,8,["modelValue","options","content-loading","invalid"])]),_:1},8,["label","content-loading","error"]),a(b,{label:_.$t("wizard.mail.host"),"content-loading":i.isFetchingInitialData,error:e(s).sesConfig.mail_host.$error&&e(s).sesConfig.mail_host.$errors[0].$message,required:""},{default:c(()=>[a(V,{modelValue:n.value.mail_host,"onUpdate:modelValue":t[1]||(t[1]=w=>n.value.mail_host=w),modelModifiers:{trim:!0},invalid:e(s).sesConfig.mail_host.$error,"content-loading":i.isFetchingInitialData,type:"text",name:"mail_host",onInput:t[2]||(t[2]=w=>e(s).sesConfig.mail_host.$touch())},null,8,["modelValue","invalid","content-loading"])]),_:1},8,["label","content-loading","error"])]),q("div",ha,[a(b,{label:_.$t("wizard.mail.port"),"content-loading":i.isFetchingInitialData,error:e(s).sesConfig.mail_port.$error&&e(s).sesConfig.mail_port.$errors[0].$message,required:""},{default:c(()=>[a(V,{modelValue:n.value.mail_port,"onUpdate:modelValue":t[3]||(t[3]=w=>n.value.mail_port=w),modelModifiers:{trim:!0},invalid:e(s).sesConfig.mail_port.$error,"content-loading":i.isFetchingInitialData,type:"text",name:"mail_port",onInput:t[4]||(t[4]=w=>e(s).sesConfig.mail_port.$touch())},null,8,["modelValue","invalid","content-loading"])]),_:1},8,["label","content-loading","error"]),a(b,{label:_.$t("wizard.mail.encryption"),"content-loading":i.isFetchingInitialData,error:e(s).sesConfig.mail_encryption.$error&&e(s).sesConfig.mail_encryption.$errors[0].$message,required:""},{default:c(()=>[a(m,{modelValue:n.value.mail_encryption,"onUpdate:modelValue":t[5]||(t[5]=w=>n.value.mail_encryption=w),modelModifiers:{trim:!0},invalid:e(s).sesConfig.mail_encryption.$error,options:u,"content-loading":i.isFetchingInitialData,onInput:t[6]||(t[6]=w=>e(s).sesConfig.mail_encryption.$touch())},null,8,["modelValue","invalid","options","content-loading"])]),_:1},8,["label","content-loading","error"])]),q("div",ya,[a(b,{label:_.$t("wizard.mail.from_mail"),"content-loading":i.isFetchingInitialData,error:e(s).sesConfig.from_mail.$error&&e(s).sesConfig.from_mail.$errors[0].$message,required:""},{default:c(()=>[a(V,{modelValue:n.value.from_mail,"onUpdate:modelValue":t[7]||(t[7]=w=>n.value.from_mail=w),modelModifiers:{trim:!0},invalid:e(s).sesConfig.from_mail.$error,"content-loading":i.isFetchingInitialData,type:"text",name:"from_mail",onInput:t[8]||(t[8]=w=>e(s).sesConfig.from_mail.$touch())},null,8,["modelValue","invalid","content-loading"])]),_:1},8,["label","content-loading","error"]),a(b,{label:_.$t("wizard.mail.from_name"),"content-loading":i.isFetchingInitialData,error:e(s).sesConfig.from_name.$error&&e(s).sesConfig.from_name.$errors[0].$message,required:""},{default:c(()=>[a(V,{modelValue:n.value.from_name,"onUpdate:modelValue":t[9]||(t[9]=w=>n.value.from_name=w),modelModifiers:{trim:!0},invalid:e(s).sesConfig.from_name.$error,"content-loading":i.isFetchingInitialData,type:"text",name:"name",onInput:t[10]||(t[10]=w=>e(s).sesConfig.from_name.$touch())},null,8,["modelValue","invalid","content-loading"])]),_:1},8,["label","content-loading","error"])]),q("div",Ia,[a(b,{label:_.$t("wizard.mail.ses_key"),"content-loading":i.isFetchingInitialData,error:e(s).sesConfig.mail_ses_key.$error&&e(s).sesConfig.mail_ses_key.$errors[0].$message,required:""},{default:c(()=>[a(V,{modelValue:n.value.mail_ses_key,"onUpdate:modelValue":t[11]||(t[11]=w=>n.value.mail_ses_key=w),modelModifiers:{trim:!0},invalid:e(s).sesConfig.mail_ses_key.$error,"content-loading":i.isFetchingInitialData,type:"text",name:"mail_ses_key",onInput:t[12]||(t[12]=w=>e(s).sesConfig.mail_ses_key.$touch())},null,8,["modelValue","invalid","content-loading"])]),_:1},8,["label","content-loading","error"]),a(b,{label:_.$t("wizard.mail.ses_secret"),"content-loading":i.isFetchingInitialData,error:e(s).sesConfig.mail_ses_secret.$error&&e(s).sesConfig.mail_ses_secret.$errors[0].$message,required:""},{default:c(()=>[a(V,{modelValue:n.value.mail_ses_secret,"onUpdate:modelValue":t[14]||(t[14]=w=>n.value.mail_ses_secret=w),modelModifiers:{trim:!0},invalid:e(s).sesConfig.mail_ses_secret.$error,type:_.getInputType,"content-loading":i.isFetchingInitialData,name:"mail_ses_secret",autocomplete:"off","data-lpignore":"true",onInput:t[15]||(t[15]=w=>e(s).sesConfig.mail_ses_secret.$touch())},{right:c(()=>[a($,{name:e(l)?"EyeIcon":"EyeSlashIcon",class:"mr-1 text-gray-500 cursor-pointer",onClick:t[13]||(t[13]=w=>te(l)?l.value=!e(l):l=!e(l))},null,8,["name"])]),_:1},8,["modelValue","invalid","type","content-loading"])]),_:1},8,["label","content-loading","error"]),a(b,{label:_.$t("settings.mail.ses_region"),"content-loading":i.isFetchingInitialData,error:e(s).sesConfig.mail_ses_region.$error&&e(s).sesConfig.mail_ses_region.$errors[0].$message,required:""},{default:c(()=>[a(V,{modelValue:e(d).sesConfig.mail_ses_region,"onUpdate:modelValue":t[16]||(t[16]=w=>e(d).sesConfig.mail_ses_region=w),modelModifiers:{trim:!0},"content-loading":i.isFetchingInitialData,type:"text",name:"mail_ses_region",invalid:e(s).sesConfig.mail_ses_region.$error,onInput:t[17]||(t[17]=w=>e(s).sesConfig.mail_ses_region.$touch())},null,8,["modelValue","content-loading","invalid"])]),_:1},8,["label","content-loading","error"])]),a(v,{loading:i.isSaving,disabled:i.isSaving,"content-loading":i.isFetchingInitialData,class:"mt-4"},{left:c(w=>[i.isSaving?E("",!0):(S(),U($,{key:0,name:"ArrowDownOnSquareIcon",class:A(w.class)},null,8,["class"]))]),default:c(()=>[L(" "+k(_.$t("general.save")),1)]),_:1},8,["loading","disabled","content-loading"])],32)}}},Va={class:"grid grid-cols-1 gap-4 mb-4 md:grid-cols-2 md:mb-6"},Ba={class:"grid grid-cols-1 gap-4 mb-6 md:grid-cols-2"},ve={__name:"BasicMailDriver",props:{isSaving:{type:Boolean,require:!0,default:!1},isFetchingInitialData:{type:Boolean,require:!0,default:!1}},emits:["submit-data","on-change-driver"],setup(i,{emit:C}){const D=C,{t:r}=W.useI18n(),u=X(),l=z(()=>u.basicMailConfig);z(()=>u.mail_drivers),l.value.mail_driver="mail";const d=z(()=>({basicMailConfig:{mail_driver:{required:y.withMessage(r("validation.required"),B)},from_mail:{required:y.withMessage(r("validation.required"),B),email:y.withMessage(r("validation.email_incorrect"),Q)},from_name:{required:y.withMessage(r("validation.required"),B)}}})),n=j(d,z(()=>u));function g(){return n.value.$touch(),n.value.$invalid||D("submit-data",u.basicMailConfig),!1}function s(){var f;n.value.basicMailConfig.mail_driver.$touch(),D("on-change-driver",(f=u==null?void 0:u.basicMailConfig)==null?void 0:f.mail_driver)}return(f,o)=>{const _=h("BaseMultiselect"),t=h("BaseInputGroup"),m=h("BaseInput"),b=h("BaseIcon"),V=h("BaseButton");return S(),P("form",{onSubmit:x(g,["prevent"])},[q("div",Va,[a(t,{label:f.$t("wizard.mail.driver"),"content-loading":i.isFetchingInitialData,error:e(n).basicMailConfig.mail_driver.$error&&e(n).basicMailConfig.mail_driver.$errors[0].$message,required:""},{default:c(()=>[a(_,{modelValue:l.value.mail_driver,"onUpdate:modelValue":[o[0]||(o[0]=$=>l.value.mail_driver=$),s],invalid:e(n).basicMailConfig.mail_driver.$error,options:e(u).mail_drivers,"can-deselect":!1,"content-loading":i.isFetchingInitialData},null,8,["modelValue","invalid","options","content-loading"])]),_:1},8,["label","content-loading","error"])]),q("div",Ba,[a(t,{label:f.$t("wizard.mail.from_name"),"content-loading":i.isFetchingInitialData,error:e(n).basicMailConfig.from_name.$error&&e(n).basicMailConfig.from_name.$errors[0].$message,required:""},{default:c(()=>[a(m,{modelValue:l.value.from_name,"onUpdate:modelValue":o[1]||(o[1]=$=>l.value.from_name=$),modelModifiers:{trim:!0},invalid:e(n).basicMailConfig.from_name.$error,"content-loading":i.isFetchingInitialData,type:"text",name:"name",onInput:o[2]||(o[2]=$=>e(n).basicMailConfig.from_name.$touch())},null,8,["modelValue","invalid","content-loading"])]),_:1},8,["label","content-loading","error"]),a(t,{label:f.$t("wizard.mail.from_mail"),"content-loading":i.isFetchingInitialData,error:e(n).basicMailConfig.from_mail.$error&&e(n).basicMailConfig.from_mail.$errors[0].$message,required:""},{default:c(()=>[a(m,{modelValue:l.value.from_mail,"onUpdate:modelValue":o[3]||(o[3]=$=>l.value.from_mail=$),modelModifiers:{trim:!0},invalid:e(n).basicMailConfig.from_mail.$error,"content-loading":i.isFetchingInitialData,type:"text",onInput:o[4]||(o[4]=$=>e(n).basicMailConfig.from_mail.$touch())},null,8,["modelValue","invalid","content-loading"])]),_:1},8,["label","content-loading","error"])]),a(V,{loading:i.isSaving,disabled:i.isSaving,"content-loading":i.isFetchingInitialData,class:"mt-4"},{left:c($=>[i.isSaving?E("",!0):(S(),U(b,{key:0,name:"ArrowDownOnSquareIcon",class:A($.class)},null,8,["class"]))]),default:c(()=>[L(" "+k(f.$t("general.save")),1)]),_:1},8,["loading","disabled","content-loading"])],32)}}},Ca={components:{Smtp:fa,Mailgun:$a,Ses:qa,sendmail:ve,Mail:ve},emits:["next"],setup(i,{emit:C}){const D=M(!1),r=M(!1),u=X();u.mail_driver="mail",d();function l(g){u.mail_driver=g}async function d(){r.value=!0,await u.fetchMailDrivers(),r.value=!1}async function n(g){D.value=!0;let s=await u.updateMailConfig(g);D.value=!1,s.data.success&&await C("next",5)}return{mailDriverStore:u,isSaving:D,isFetchingInitialData:r,changeDriver:l,next:n}}};function Da(i,C,D,r,u,l){const d=h("BaseWizardStep");return S(),U(d,{title:i.$t("wizard.mail.mail_config"),description:i.$t("wizard.mail.mail_config_desc")},{default:c(()=>[q("form",{action:"",onSubmit:C[1]||(C[1]=x((...n)=>r.next&&r.next(...n),["prevent"]))},[(S(),U(ce(r.mailDriverStore.mail_driver),{"config-data":r.mailDriverStore.mailConfigData,"is-saving":r.isSaving,"is-fetching-initial-data":r.isFetchingInitialData,onOnChangeDriver:C[0]||(C[0]=n=>r.changeDriver(n)),onSubmitData:r.next},null,40,["config-data","is-saving","is-fetching-initial-data","onSubmitData"]))],32)]),_:1},8,["title","description"])}const Sa=ue(Ca,[["render",Da]]),Fa={class:"grid grid-cols-1 mb-4 md:grid-cols-2 md:mb-6"},Ma={class:"grid grid-cols-1 gap-4 mb-4 md:grid-cols-2 md:mb-6"},za={class:"grid grid-cols-1 gap-4 mb-6 md:grid-cols-2"},ka={__name:"Step6AccountSettings",emits:["next"],setup(i,{emit:C}){const D=C;let r=M(!1);const u=M(!1),l=M(!1);let d=M(""),n=M(null);const g=pe(),s=ee(),{t:f}=W.useI18n(),o=z(()=>g.userForm),_=z(()=>({userForm:{name:{required:y.withMessage(f("validation.required"),B)},email:{required:y.withMessage(f("validation.required"),B),email:y.withMessage(f("validation.email_incorrect"),Q)},password:{required:y.withMessage(f("validation.required"),B),minLength:y.withMessage(f("validation.password_min_length",{count:8}),ye(8))},confirm_password:{required:y.withMessage(f("validation.required"),he(g.userForm.password)),sameAsPassword:y.withMessage(f("validation.password_incorrect"),we(g.userForm.password))}}})),t=j(_,z(()=>g));function m($,v){n.value=v}function b(){n.value=null}async function V(){if(t.value.userForm.$touch(),t.value.userForm.$invalid)return!0;r.value=!0;let $=await g.updateCurrentUser(o.value);if(r.value=!1,$.data.data){if(n.value){let w=new FormData;w.append("admin_avatar",n.value),await g.uploadAvatar(w)}const v=$.data.data.companies[0];await s.setSelectedCompany(v),D("next",6)}}return($,v)=>{const w=h("BaseFileUploader"),p=h("BaseInputGroup"),I=h("BaseInput"),N=h("BaseIcon"),R=h("BaseButton"),Z=h("BaseWizardStep");return S(),U(Z,{title:$.$t("wizard.account_info"),description:$.$t("wizard.account_info_desc")},{default:c(()=>[q("form",{action:"",onSubmit:x(V,["prevent"])},[q("div",Fa,[a(p,{label:$.$t("settings.account_settings.profile_picture")},{default:c(()=>[a(w,{avatar:!0,"preview-image":e(d),onChange:m,onRemove:b},null,8,["preview-image"])]),_:1},8,["label"])]),q("div",Ma,[a(p,{label:$.$t("wizard.name"),error:e(t).userForm.name.$error&&e(t).userForm.name.$errors[0].$message,required:""},{default:c(()=>[a(I,{modelValue:o.value.name,"onUpdate:modelValue":v[0]||(v[0]=O=>o.value.name=O),modelModifiers:{trim:!0},invalid:e(t).userForm.name.$error,type:"text",name:"name",onInput:v[1]||(v[1]=O=>e(t).userForm.name.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),a(p,{label:$.$t("wizard.email"),error:e(t).userForm.email.$error&&e(t).userForm.email.$errors[0].$message,required:""},{default:c(()=>[a(I,{modelValue:o.value.email,"onUpdate:modelValue":v[2]||(v[2]=O=>o.value.email=O),modelModifiers:{trim:!0},invalid:e(t).userForm.email.$error,type:"text",name:"email",onInput:v[3]||(v[3]=O=>e(t).userForm.email.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"])]),q("div",za,[a(p,{label:$.$t("wizard.password"),error:e(t).userForm.password.$error&&e(t).userForm.password.$errors[0].$message,required:""},{default:c(()=>[a(I,{modelValue:o.value.password,"onUpdate:modelValue":v[5]||(v[5]=O=>o.value.password=O),modelModifiers:{trim:!0},invalid:e(t).userForm.password.$error,type:u.value?"text":"password",name:"password",onInput:v[6]||(v[6]=O=>e(t).userForm.password.$touch())},{right:c(()=>[a(N,{name:u.value?"EyeIcon":"EyeSlashIcon",class:"mr-1 text-gray-500 cursor-pointer",onClick:v[4]||(v[4]=O=>u.value=!u.value)},null,8,["name"])]),_:1},8,["modelValue","invalid","type"])]),_:1},8,["label","error"]),a(p,{label:$.$t("wizard.confirm_password"),error:e(t).userForm.confirm_password.$error&&e(t).userForm.confirm_password.$errors[0].$message,required:""},{default:c(()=>[a(I,{modelValue:o.value.confirm_password,"onUpdate:modelValue":v[8]||(v[8]=O=>o.value.confirm_password=O),modelModifiers:{trim:!0},invalid:e(t).userForm.confirm_password.$error,type:l.value?"text":"password",name:"confirm_password",onInput:v[9]||(v[9]=O=>e(t).userForm.confirm_password.$touch())},{right:c(()=>[a(N,{name:l.value?"EyeIcon":"EyeSlashIcon",class:"mr-1 text-gray-500 cursor-pointer",onClick:v[7]||(v[7]=O=>l.value=!l.value)},null,8,["name"])]),_:1},8,["modelValue","invalid","type"])]),_:1},8,["label","error"])]),a(R,{loading:e(r),disabled:e(r),class:"mt-4"},{left:c(O=>[e(r)?E("",!0):(S(),U(N,{key:0,name:"ArrowDownOnSquareIcon",class:A(O.class)},null,8,["class"]))]),default:c(()=>[L(" "+k($.$t("wizard.save_cont")),1)]),_:1},8,["loading","disabled"])],32)]),_:1},8,["title","description"])}}},Ua={class:"grid grid-cols-1 mb-4 md:grid-cols-2 md:mb-6"},Pa={class:"grid grid-cols-1 gap-4 mb-4 md:grid-cols-2 md:mb-6"},La={class:"grid grid-cols-1 gap-4 mb-4 md:grid-cols-2 md:mb-6"},Oa={class:"grid grid-cols-1 gap-4 mb-6 md:grid-cols-2"},Na={__name:"Step7CompanyInfo",emits:["next"],setup(i,{emit:C}){const D=C;let r=M(!1),u=M(!1);const{t:l}=W.useI18n();let d=M(null),n=M(null),g=M(null);const s=J({name:null,tax_id:null,vat_id:null,address:{address_street_1:"",address_street_2:"",website:"",country_id:null,state:"",city:"",phone:"",zip:""}}),f=ee(),o=_e();K(async()=>{var $;r.value=!0,await o.fetchCountries(),r.value=!1,s.address.country_id=($=o.countries.find(v=>v.code=="US"))==null?void 0:$.id});const _={companyForm:{name:{required:y.withMessage(l("validation.required"),B)},address:{country_id:{required:y.withMessage(l("validation.required"),B)},address_street_1:{maxLength:y.withMessage(l("validation.address_maxlength",{count:255}),ge(255))},address_street_2:{maxLength:y.withMessage(l("validation.address_maxlength",{count:255}),ge(255))}}}},t=j(_,{companyForm:s});function m($,v,w,p){g.value=p.name,n.value=v}function b(){n.value=null}async function V(){if(t.value.companyForm.$touch(),t.value.$invalid)return!0;if(u.value=!0,f.updateCompany(s)){if(n.value){let v=new FormData;v.append("company_logo",JSON.stringify({name:g.value,data:n.value})),await f.updateCompanyLogo(v)}u.value=!1,D("next",7)}}return($,v)=>{const w=h("BaseFileUploader"),p=h("BaseInputGroup"),I=h("BaseInput"),N=h("BaseMultiselect"),R=h("BaseTextarea"),Z=h("BaseIcon"),O=h("BaseButton"),le=h("BaseWizardStep");return S(),U(le,{title:$.$t("wizard.company_info"),description:$.$t("wizard.company_info_desc"),"step-container":"bg-white border border-gray-200 border-solid mb-8 md:w-full p-8 rounded w-full"},{default:c(()=>[q("form",{action:"",onSubmit:x(V,["prevent"])},[q("div",Ua,[a(p,{label:$.$t("settings.company_info.company_logo")},{default:c(()=>[a(w,{base64:"","preview-image":e(d),onChange:m,onRemove:b},null,8,["preview-image"])]),_:1},8,["label"])]),q("div",Pa,[a(p,{label:$.$t("wizard.company_name"),error:e(t).companyForm.name.$error&&e(t).companyForm.name.$errors[0].$message,required:""},{default:c(()=>[a(I,{modelValue:s.name,"onUpdate:modelValue":v[0]||(v[0]=F=>s.name=F),modelModifiers:{trim:!0},invalid:e(t).companyForm.name.$error,type:"text",name:"name",onInput:v[1]||(v[1]=F=>e(t).companyForm.name.$touch())},null,8,["modelValue","invalid"])]),_:1},8,["label","error"]),a(p,{label:$.$t("wizard.country"),error:e(t).companyForm.address.country_id.$error&&e(t).companyForm.address.country_id.$errors[0].$message,"content-loading":e(r),required:""},{default:c(()=>[a(N,{modelValue:s.address.country_id,"onUpdate:modelValue":v[2]||(v[2]=F=>s.address.country_id=F),label:"name",invalid:e(t).companyForm.address.country_id.$error,options:e(o).countries,"value-prop":"id","can-deselect":!1,"can-clear":!1,"content-loading":e(r),placeholder:$.$t("general.select_country"),searchable:"","track-by":"name"},null,8,["modelValue","invalid","options","content-loading","placeholder"])]),_:1},8,["label","error","content-loading"])]),q("div",La,[a(p,{label:$.$t("wizard.state")},{default:c(()=>[a(I,{modelValue:s.address.state,"onUpdate:modelValue":v[3]||(v[3]=F=>s.address.state=F),name:"state",type:"text"},null,8,["modelValue"])]),_:1},8,["label"]),a(p,{label:$.$t("wizard.city")},{default:c(()=>[a(I,{modelValue:s.address.city,"onUpdate:modelValue":v[4]||(v[4]=F=>s.address.city=F),name:"city",type:"text"},null,8,["modelValue"])]),_:1},8,["label"])]),q("div",Oa,[q("div",null,[a(p,{label:$.$t("wizard.address"),error:e(t).companyForm.address.address_street_1.$error&&e(t).companyForm.address.address_street_1.$errors[0].$message},{default:c(()=>[a(R,{modelValue:s.address.address_street_1,"onUpdate:modelValue":v[5]||(v[5]=F=>s.address.address_street_1=F),modelModifiers:{trim:!0},invalid:e(t).companyForm.address.address_street_1.$error,placeholder:$.$t("general.street_1"),name:"billing_street1",rows:"2",onInput:v[6]||(v[6]=F=>e(t).companyForm.address.address_street_1.$touch())},null,8,["modelValue","invalid","placeholder"])]),_:1},8,["label","error"]),a(p,{error:e(t).companyForm.address.address_street_2.$error&&e(t).companyForm.address.address_street_2.$errors[0].$message,class:"mt-1 lg:mt-2 md:mt-2"},{default:c(()=>[a(R,{modelValue:s.address.address_street_2,"onUpdate:modelValue":v[7]||(v[7]=F=>s.address.address_street_2=F),invalid:e(t).companyForm.address.address_street_2.$error,placeholder:$.$t("general.street_2"),name:"billing_street2",rows:"2",onInput:v[8]||(v[8]=F=>e(t).companyForm.address.address_street_2.$touch())},null,8,["modelValue","invalid","placeholder"])]),_:1},8,["error"])]),q("div",null,[a(p,{label:$.$t("wizard.zip_code")},{default:c(()=>[a(I,{modelValue:s.address.zip,"onUpdate:modelValue":v[9]||(v[9]=F=>s.address.zip=F),modelModifiers:{trim:!0},type:"text",name:"zip"},null,8,["modelValue"])]),_:1},8,["label"]),a(p,{label:$.$t("wizard.phone"),class:"mt-4"},{default:c(()=>[a(I,{modelValue:s.address.phone,"onUpdate:modelValue":v[10]||(v[10]=F=>s.address.phone=F),modelModifiers:{trim:!0},type:"text",name:"phone"},null,8,["modelValue"])]),_:1},8,["label"])]),a(p,{label:$.$t("settings.company_info.tax_id")},{default:c(()=>[a(I,{modelValue:s.tax_id,"onUpdate:modelValue":v[11]||(v[11]=F=>s.tax_id=F),modelModifiers:{trim:!0},type:"text",name:"tax_id"},null,8,["modelValue"])]),_:1},8,["label"]),a(p,{label:$.$t("settings.company_info.vat_id")},{default:c(()=>[a(I,{modelValue:s.vat_id,"onUpdate:modelValue":v[12]||(v[12]=F=>s.vat_id=F),modelModifiers:{trim:!0},type:"text",name:"vat_id"},null,8,["modelValue"])]),_:1},8,["label"])]),a(O,{loading:e(u),disabled:e(u),class:"mt-4"},{left:c(F=>[e(u)?E("",!0):(S(),U(Z,{key:0,name:"ArrowDownOnSquareIcon",class:A(F.class)},null,8,["class"]))]),default:c(()=>[L(" "+k($.$t("wizard.save_cont")),1)]),_:1},8,["loading","disabled"])],32)]),_:1},8,["title","description"])}}},Ga={class:"grid grid-cols-1 gap-4 mb-4 md:grid-cols-2 md:mb-6"},Ea={class:"grid grid-cols-1 gap-4 mb-4 md:grid-cols-2 md:mb-6"},Aa={class:"grid grid-cols-1 gap-4 mb-6 md:grid-cols-2"},Wa={__name:"Step8CompanyPreferences",emits:["next"],setup(i,{emit:C}){const D=C,r=M(!1);let u=M(!1),l=J({currency:3,language:"en",carbon_date_format:"d M Y",time_zone:"UTC",fiscal_year:"1-12"});const{tm:d,t:n}=W.useI18n(),g=be();u.value=!0;const s=z(()=>o.fiscalYears.map(p=>Object.assign({},p,{key:n(p.key)})));J([{title:d("settings.customization.invoices.allow"),value:"allow"},{title:d("settings.customization.invoices.disable_on_invoice_partial_paid"),value:"disable_on_invoice_partial_paid"},{title:d("settings.customization.invoices.disable_on_invoice_paid"),value:"disable_on_invoice_paid"},{title:d("settings.customization.invoices.disable_on_invoice_sent"),value:"disable_on_invoice_sent"}]);const f=fe(),o=_e(),_=ee(),t=pe(),m=me();let b={key:"fiscal_years"},V={key:"languages"};u.value=!0,Promise.all([o.fetchCurrencies(),o.fetchDateFormats(),o.fetchTimeZones(),o.fetchCountries(),o.fetchConfig(b),o.fetchConfig(V)]).then(([p])=>{u.value=!1});const $=z(()=>({currentPreferences:{currency:{required:y.withMessage(n("validation.required"),B)},language:{required:y.withMessage(n("validation.required"),B)},carbon_date_format:{required:y.withMessage(n("validation.required"),B)},time_zone:{required:y.withMessage(n("validation.required"),B)},fiscal_year:{required:y.withMessage(n("validation.required"),B)}}})),v=j($,{currentPreferences:l});async function w(){if(v.value.currentPreferences.$touch(),v.value.$invalid)return!0;f.openDialog({title:n("general.do_you_wish_to_continue"),message:n("wizard.currency_set_alert"),yesLabel:n("general.ok"),noLabel:n("general.cancel"),variant:"danger",size:"lg",hideNoButton:!1}).then(async p=>{if(p){let I={settings:{...l}};r.value=!0,delete I.settings.discount_per_item;let N=await _.updateCompanySettings({data:I});if(N.data){r.value=!1;let R={settings:{language:l.language}};(await t.updateUserSettings(R)).data&&(D("next","COMPLETED"),m.showNotification({type:"success",message:"Login Successful"}),g.push("/admin/dashboard")),Ie.set("auth.token",N.data.token)}return!0}return r.value=!1,!0})}return(p,I)=>{const N=h("BaseMultiselect"),R=h("BaseInputGroup"),Z=h("BaseIcon"),O=h("BaseButton"),le=h("BaseWizardStep");return S(),U(le,{title:p.$t("wizard.preferences"),description:p.$t("wizard.preferences_desc"),"step-container":"bg-white border border-gray-200 border-solid mb-8 md:w-full p-8 rounded w-full"},{default:c(()=>[q("form",{action:"",onSubmit:x(w,["prevent"])},[q("div",null,[q("div",Ga,[a(R,{label:p.$t("wizard.currency"),error:e(v).currentPreferences.currency.$error&&e(v).currentPreferences.currency.$errors[0].$message,"content-loading":e(u),required:""},{default:c(()=>[a(N,{modelValue:e(l).currency,"onUpdate:modelValue":I[0]||(I[0]=F=>e(l).currency=F),"content-loading":e(u),options:e(o).currencies,label:"name","value-prop":"id",searchable:!0,"track-by":"name",placeholder:p.$t("settings.currencies.select_currency"),invalid:e(v).currentPreferences.currency.$error,class:"w-full"},null,8,["modelValue","content-loading","options","placeholder","invalid"])]),_:1},8,["label","error","content-loading"]),a(R,{label:p.$t("settings.preferences.default_language"),error:e(v).currentPreferences.language.$error&&e(v).currentPreferences.language.$errors[0].$message,"content-loading":e(u),required:""},{default:c(()=>[a(N,{modelValue:e(l).language,"onUpdate:modelValue":I[1]||(I[1]=F=>e(l).language=F),"content-loading":e(u),options:e(o).languages,label:"name","value-prop":"code",placeholder:p.$t("settings.preferences.select_language"),class:"w-full","track-by":"name",searchable:!0,invalid:e(v).currentPreferences.language.$error},null,8,["modelValue","content-loading","options","placeholder","invalid"])]),_:1},8,["label","error","content-loading"])]),q("div",Ea,[a(R,{label:p.$t("wizard.date_format"),error:e(v).currentPreferences.carbon_date_format.$error&&e(v).currentPreferences.carbon_date_format.$errors[0].$message,"content-loading":e(u),required:""},{default:c(()=>[a(N,{modelValue:e(l).carbon_date_format,"onUpdate:modelValue":I[2]||(I[2]=F=>e(l).carbon_date_format=F),"content-loading":e(u),options:e(o).dateFormats,label:"display_date","value-prop":"carbon_format_value",placeholder:p.$t("settings.preferences.select_date_format"),"track-by":"display_date",searchable:"",invalid:e(v).currentPreferences.carbon_date_format.$error,class:"w-full"},null,8,["modelValue","content-loading","options","placeholder","invalid"])]),_:1},8,["label","error","content-loading"]),a(R,{label:p.$t("wizard.time_zone"),error:e(v).currentPreferences.time_zone.$error&&e(v).currentPreferences.time_zone.$errors[0].$message,"content-loading":e(u),required:""},{default:c(()=>[a(N,{modelValue:e(l).time_zone,"onUpdate:modelValue":I[3]||(I[3]=F=>e(l).time_zone=F),"content-loading":e(u),options:e(o).timeZones,label:"key","value-prop":"value",placeholder:p.$t("settings.preferences.select_time_zone"),"track-by":"key",searchable:!0,invalid:e(v).currentPreferences.time_zone.$error},null,8,["modelValue","content-loading","options","placeholder","invalid"])]),_:1},8,["label","error","content-loading"])]),q("div",Aa,[a(R,{label:p.$t("wizard.fiscal_year"),error:e(v).currentPreferences.fiscal_year.$error&&e(v).currentPreferences.fiscal_year.$errors[0].$message,"content-loading":e(u),required:""},{default:c(()=>[a(N,{modelValue:e(l).fiscal_year,"onUpdate:modelValue":I[4]||(I[4]=F=>e(l).fiscal_year=F),"content-loading":e(u),options:s.value,label:"key","value-prop":"value",placeholder:p.$t("settings.preferences.select_financial_year"),invalid:e(v).currentPreferences.fiscal_year.$error,"track-by":"key",searchable:!0,class:"w-full"},null,8,["modelValue","content-loading","options","placeholder","invalid"])]),_:1},8,["label","error","content-loading"])]),a(O,{loading:r.value,disabled:r.value,"content-loading":e(u),class:"mt-4"},{left:c(F=>[a(Z,{name:"ArrowDownOnSquareIcon",class:A(F.class)},null,8,["class"])]),default:c(()=>[L(" "+k(p.$t("wizard.save_cont")),1)]),_:1},8,["loading","disabled","content-loading"])])],32)]),_:1},8,["title","description"])}}},Ra={components:{step_0:Be,step_1:Ge,step_2:xe,step_3:ia,step_4:ua,step_5:Sa,step_6:ka,step_7:Na,step_8:Wa},setup(){let i=M("step_0"),C=M(0);const D=be(),r=Y(),{global:u}=window.i18n;l();async function l(){let f=await r.fetchInstallationStep();if(f.data.profile_complete==="COMPLETED"){D.push("/admin/dashboard");return}typeof f.data.profile_language=="string"&&await window.loadLanguage(f.data.profile_language);let o=parseInt(f.data.profile_complete);o&&(C.value=o+1,i.value=`step_${o+1}`)}async function d(f){var _,t;let o={profile_complete:f};try{return await r.addInstallationStep(o),!0}catch(m){return((t=(_=m==null?void 0:m.response)==null?void 0:_.data)==null?void 0:t.message)==="The MAC is invalid."&&window.location.reload(),!1}}async function n(f){if(f&&!await d(f))return!1;C.value++,C.value<=9&&(i.value="step_"+C.value)}function g(f){}function s(){return new URL("/build/assets/logo-B-kJLjJy.png",import.meta.url)}return{stepComponent:i,currentStepNumber:C,onStepChange:n,saveStepProgress:d,onNavClick:g,getTickImage:s}}},Ta={class:"flex flex-col items-center justify-between w-full pt-10"},ja=["src"];function xa(i,C,D,r,u,l){const d=h("BaseWizard");return S(),P("div",Ta,[q("img",{id:"logo-invoiceshelf",src:r.getTickImage(),alt:"InvoiceShelf Logo",class:"h-12 mb-5 md:mb-10"},null,8,ja),a(d,{steps:9,"current-step":r.currentStepNumber,onClick:r.onNavClick},{default:c(()=>[(S(),U(ce(r.stepComponent),{onNext:r.onStepChange},null,40,["onNext"]))]),_:1},8,["current-step","onClick"])])}const Ha=ue(Ra,[["render",xa]]);export{Ha as default};
