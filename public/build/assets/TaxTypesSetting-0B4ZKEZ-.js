import{a9 as J,u as W,v as z,av as U,N as Z,O as j,G as L,a7 as X,r as d,K as m,o as r,w as l,L as w,l as y,V as v,a as n,q as T,t as B,F as ee,aw as te,e as M,j as f,I as ae,a8 as O,M as se,c as Y,Q as F}from"./main-DnObvGgc.js";import{_ as ne}from"./TaxTypeModal-Byuj8aRW.js";const le={__name:"TaxTypeIndexDropdown",props:{row:{type:Object,default:null},table:{type:Object,default:null},loadData:{type:Function,default:null}},setup(C){const o=C,I=J();W();const{t:s}=z.useI18n(),E=U(),$=Z(),x=j(),N=L();X("utils");async function c(p){await E.fetchTaxType(p),N.openModal({title:s("settings.tax_types.edit_tax"),componentName:"TaxTypeModal",size:"sm",refreshData:o.loadData&&o.loadData})}function D(p){I.openDialog({title:s("general.are_you_sure"),message:s("settings.tax_types.confirm_delete"),yesLabel:s("general.ok"),noLabel:s("general.cancel"),variant:"danger",hideNoButton:!1,size:"lg"}).then(async _=>{if(_){if((await E.deleteTaxType(p)).data.success)return o.loadData&&o.loadData(),!0;o.loadData&&o.loadData()}})}return(p,_)=>{const g=d("BaseIcon"),h=d("BaseButton"),i=d("BaseDropdownItem"),S=d("BaseDropdown");return r(),m(S,null,{activator:l(()=>[y($).name==="tax-types.view"?(r(),m(h,{key:0,variant:"primary"},{default:l(()=>[n(g,{name:"EllipsisHorizontalIcon",class:"h-5 text-white"})]),_:1})):(r(),m(g,{key:1,name:"EllipsisHorizontalIcon",class:"h-5 text-gray-500"}))]),default:l(()=>[y(x).hasAbilities(y(v).EDIT_TAX_TYPE)?(r(),m(i,{key:0,onClick:_[0]||(_[0]=k=>c(C.row.id))},{default:l(()=>[n(g,{name:"PencilIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),T(" "+B(p.$t("general.edit")),1)]),_:1})):w("",!0),y(x).hasAbilities(y(v).DELETE_TAX_TYPE)?(r(),m(i,{key:1,onClick:_[1]||(_[1]=k=>D(C.row.id))},{default:l(()=>[n(g,{name:"TrashIcon",class:"w-5 h-5 mr-3 text-gray-400 group-hover:text-gray-500"}),T(" "+B(p.$t("general.delete")),1)]),_:1})):w("",!0)]),_:1})}}},oe={key:0},re={__name:"TaxTypesSetting",setup(C){const{t:o}=z.useI18n(),I=X("utils"),s=ee(),E=U(),$=L(),x=j(),N=te(),c=M(null),D=M(s.selectedCompanySettings.tax_per_item),p=f(()=>s.selectedCompanyCurrency),_=f(()=>[{key:"name",label:o("settings.tax_types.tax_name"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"calculation_type",label:o("settings.tax_types.calculation_type"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"amount",label:o("settings.tax_types.amount"),thClass:"extra",tdClass:"font-medium text-gray-900"},{key:"actions",label:"",tdClass:"text-right text-sm font-medium",sortable:!1}]),g=f(()=>s.selectedCompanySettings.sales_tax_us_enabled==="YES"&&N.salesTaxUSEnabled),h=f({get:()=>D.value==="YES",set:async e=>{const a=e?"YES":"NO";let u={settings:{tax_per_item:a}};D.value=a,await s.updateCompanySettings({data:u,message:"general.setting_updated"})}}),i=ae({tax_included:"NO",tax_included_by_default:"NO"});I.mergeSettings(i,{...s.selectedCompanySettings});const S=f({get:()=>i.tax_included==="YES",set:async e=>{const a=e?"YES":"NO";i.tax_included=a,e||(i.tax_included_by_default="NO");let u={settings:{...i}};await s.updateCompanySettings({data:u,message:"general.setting_updated"})}}),k=f({get:()=>i.tax_included_by_default==="YES",set:async e=>{const a=e?"YES":"NO";i.tax_included_by_default=a;let u={settings:{tax_included_by_default:i.tax_included_by_default}};await s.updateCompanySettings({data:u,message:"general.setting_updated"})}});function H(){return x.hasAbilities([v.DELETE_TAX_TYPE,v.EDIT_TAX_TYPE])}async function R({page:e,filter:a,sort:u}){let A={orderByField:u.fieldName||"created_at",orderBy:u.order||"desc",page:e},b=await E.fetchTaxTypes(A);return{data:b.data.data,pagination:{totalPages:b.data.meta.last_page,currentPage:e,totalCount:b.data.meta.total,limit:5}}}async function q(){c.value&&c.value.refresh()}function G(){$.openModal({title:o("settings.tax_types.add_tax"),componentName:"TaxTypeModal",size:"sm",refreshData:c.value&&c.value.refresh})}return(e,a)=>{const u=d("BaseIcon"),A=d("BaseButton"),b=d("BaseFormatMoney"),K=d("BaseTable"),P=d("BaseDivider"),V=d("BaseSwitchSection"),Q=d("BaseSettingCard");return r(),m(Q,{title:e.$t("settings.tax_types.title"),description:e.$t("settings.tax_types.description")},O({default:l(()=>[n(ne),n(K,{ref_key:"table",ref:c,class:"mt-16",data:R,columns:_.value},O({"cell-calculation_type":l(({row:t})=>[T(B(e.$t(`settings.tax_types.${t.data.calculation_type}`)),1)]),"cell-amount":l(({row:t})=>[t.data.calculation_type==="percentage"?(r(),Y(F,{key:0},[T(B(t.data.percent)+" % ",1)],64)):t.data.calculation_type==="fixed"?(r(),m(b,{key:1,amount:t.data.fixed_amount,currency:p.value},null,8,["amount","currency"])):(r(),Y(F,{key:2},[T(" - ")],64))]),_:2},[H()?{name:"cell-actions",fn:l(({row:t})=>[n(le,{row:t.data,table:c.value,"load-data":q},null,8,["row","table"])]),key:"0"}:void 0]),1032,["columns"]),y(x).currentUser.is_owner?(r(),Y("div",oe,[n(P,{class:"mt-8 mb-2"}),n(V,{modelValue:h.value,"onUpdate:modelValue":a[0]||(a[0]=t=>h.value=t),disabled:g.value,title:e.$t("settings.tax_types.tax_per_item"),description:e.$t("settings.tax_types.tax_setting_description")},null,8,["modelValue","disabled","title","description"]),n(P,{class:"mt-8 mb-2"}),n(V,{modelValue:S.value,"onUpdate:modelValue":a[1]||(a[1]=t=>S.value=t),title:e.$t("settings.tax_types.tax_included"),description:e.$t("settings.tax_types.tax_included_description")},null,8,["modelValue","title","description"]),S.value?(r(),m(V,{key:0,modelValue:k.value,"onUpdate:modelValue":a[2]||(a[2]=t=>k.value=t),title:e.$t("settings.tax_types.tax_included_by_default"),description:e.$t("settings.tax_types.tax_included_by_default_description")},null,8,["modelValue","title","description"])):w("",!0)])):w("",!0)]),_:2},[y(x).hasAbilities(y(v).CREATE_TAX_TYPE)?{name:"action",fn:l(()=>[n(A,{type:"submit",variant:"primary-outline",onClick:G},{left:l(t=>[n(u,{class:se(t.class),name:"PlusIcon"},null,8,["class"])]),default:l(()=>[T(" "+B(e.$t("settings.tax_types.add_new_tax")),1)]),_:1})]),key:"0"}:void 0]),1032,["title","description"])}}};export{re as default};
